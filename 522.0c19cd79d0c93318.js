"use strict";(self.webpackChunksfrs_fe=self.webpackChunksfrs_fe||[]).push([[522],{1522:(xa,J,u)=>{u.r(J),u.d(J,{IdapServiceModule:()=>fa});var m=u(9808),p=u(4996),e=u(7587);let ee=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-account-settings"]],decls:4,vars:0,consts:[[1,"container-fluid"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h4"),e._uU(2,"Account settings"),e.qZA(),e._UZ(3,"hr"),e.qZA())},styles:[""]}),o})();class te{}var h=u(5805),f=u(2964),Z=u(2021);function oe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",7),e.TgZ(1,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().getAccountSummary()}),e._UZ(2,"i",9),e.qZA(),e.qZA()}}const ae=function(){return["../user-groups"]};function ne(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",10),e.TgZ(2,"div",11),e.TgZ(3,"div"),e._uU(4,"User groups"),e.qZA(),e.TgZ(5,"div"),e.TgZ(6,"a",12),e._uU(7),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",11),e.TgZ(9,"div"),e._uU(10,"Users"),e.qZA(),e.TgZ(11,"div"),e.TgZ(12,"a",13),e._uU(13),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",14),e.TgZ(15,"div"),e._uU(16,"Policies"),e.qZA(),e.TgZ(17,"div"),e.TgZ(18,"a",15),e._uU(19),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(6),e.Q6J("routerLink",e.DdM(4,ae)),e.xp6(1),e.Oqu(null==t.accountSummary||null==t.accountSummary.data||null==t.accountSummary.data.summary?null:t.accountSummary.data.summary.groups),e.xp6(6),e.Oqu(null==t.accountSummary||null==t.accountSummary.data||null==t.accountSummary.data.summary?null:t.accountSummary.data.summary.users),e.xp6(6),e.Oqu(null==t.accountSummary||null==t.accountSummary.data||null==t.accountSummary.data.summary?null:t.accountSummary.data.summary.policies)}}function ie(o,n){if(1&o&&(e.TgZ(0,"div",16),e.TgZ(1,"h4",17),e._uU(2,"Unauthorised action"),e.qZA(),e.TgZ(3,"p"),e._uU(4),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(4),e.Oqu(t.unauthorisedDashboard.description)}}let re=(()=>{class o{constructor(t,a){this.core=t,this.idapService=a,this.loadingData=!1,this.unauthorisedDashboard={authorised:!0,description:""},this.accountSummary=new te}ngOnInit(){this.getAccountSummary()}getAccountSummary(){this.loadingData=!0,this.idapService.getAccountSummary().then(t=>{this.loadingData=!1,this.unauthorisedDashboard.authorised=!0,this.accountSummary=t,console.log("Dashboard: ",this.accountSummary)}).catch(t=>{console.error("Dashboard error: ",t),this.loadingData=!1,this.unauthorisedDashboard=this.core.getUnauthorisedErrorMessage(t)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.p),e.Y36(f.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-dashboard"]],decls:13,vars:4,consts:[[1,"container-fluid"],[1,"row","pt-5"],[1,"col-10"],["class","col d-flex justify-content-sm-end",4,"ngIf"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[3,"show"],[1,"col","d-flex","justify-content-sm-end"],[1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fas","fa-sync-alt"],[1,"row"],[1,"col","border-end"],[3,"routerLink"],["routerLink","../users"],[1,"col"],["routerLink","../policies"],[1,"alert","alert-danger"],[1,"alert-heading"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h4"),e._uU(2,"IDAP dashboard"),e.qZA(),e.TgZ(3,"div",1),e.TgZ(4,"div",2),e.TgZ(5,"h5"),e._uU(6,"IDAP resources"),e.qZA(),e.qZA(),e.YNc(7,oe,3,0,"div",3),e.qZA(),e._UZ(8,"hr"),e.YNc(9,ne,20,5,"ng-container",4),e.YNc(10,ie,5,1,"ng-template",null,5,e.W1O),e.qZA(),e._UZ(12,"ngx-loading",6)),2&t){const i=e.MAs(11);e.xp6(7),e.Q6J("ngIf",a.unauthorisedDashboard.authorised),e.xp6(2),e.Q6J("ngIf",a.unauthorisedDashboard.authorised)("ngIfElse",i),e.xp6(3),e.Q6J("show",a.loadingData)}},directives:[m.O5,p.yS,Z.RJ],styles:["a[_ngcontent-%COMP%]{font-size:xx-large}"]}),o})();var se=u(9702);let le=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-idap-service"]],decls:4,vars:0,consts:[[1,"container-fluid","ps-0","pe-0","h-100","overflow-auto","d-flex"],["type","idap"],[1,"container","pt-3","pb-5","overflow-auto"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-sidebar",1),e.TgZ(2,"section",2),e._UZ(3,"router-outlet"),e.qZA(),e.qZA())},directives:[se.k,p.lC],styles:["div[_ngcontent-%COMP%]{background-color:#fff}"]}),o})();var _=u(5861),s=u(3075),b=u(4004),S=u(3191),ce=u(7579),de=u(9841),ue=u(7272),pe=u(8306),ge=u(5698),me=u(5684),_e=u(8372),he=u(8675),Ze=u(2722),fe=u(925);const Q=new Set;let A,xe=(()=>{class o{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):ve}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function Te(o){if(!Q.has(o))try{A||(A=document.createElement("style"),A.setAttribute("type","text/css"),document.head.appendChild(A)),A.sheet&&(A.sheet.insertRule(`@media ${o} {body{ }}`,0),Q.add(o))}catch(n){console.error(n)}}(t),this._matchMedia(t)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(fe.t4))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function ve(o){return{matches:"all"===o||""===o,media:o,addListener:()=>{},removeListener:()=>{}}}let I=(()=>{class o{constructor(t,a){this._mediaMatcher=t,this._zone=a,this._queries=new Map,this._destroySubject=new ce.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return P((0,S.Eq)(t)).some(i=>this._registerQuery(i).mql.matches)}observe(t){const i=P((0,S.Eq)(t)).map(l=>this._registerQuery(l).observable);let r=(0,de.a)(i);return r=(0,ue.z)(r.pipe((0,ge.q)(1)),r.pipe((0,me.T)(1),(0,_e.b)(0))),r.pipe((0,b.U)(l=>{const d={matches:!1,breakpoints:{}};return l.forEach(({matches:x,query:X})=>{d.matches=d.matches||x,d.breakpoints[X]=x}),d}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const a=this._mediaMatcher.matchMedia(t),r={observable:new pe.y(l=>{const d=x=>this._zone.run(()=>l.next(x));return a.addListener(d),()=>{a.removeListener(d)}}).pipe((0,he.O)(a),(0,b.U)(({matches:l})=>({query:t,matches:l})),(0,Ze.R)(this._destroySubject)),mql:a};return this._queries.set(t,r),r}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(xe),e.LFG(e.R0b))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function P(o){return o.map(n=>n.split(",")).reduce((n,t)=>n.concat(t)).map(n=>n.trim())}var w=u(850),g=u(8986);const we=["stepper"];function Ae(o,n){1&o&&e._uU(0,"Details")}function ye(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.core.isEmptyOrNull(t.serviceFormGroup.value.service)?"Select a service":null==t.serviceFormGroup.value.service?null:t.serviceFormGroup.value.service.service)}}function be(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"a",52),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().selectService(r)}),e._uU(1),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.Oqu(null==t?null:t.service)}}function Ue(o,n){1&o&&(e.TgZ(0,"span"),e._uU(1,"Select resources"),e.qZA())}const Ce=function(o){return{"d-none":o}};function qe(o,n){if(1&o&&(e.TgZ(0,"div",58),e.TgZ(1,"div",54),e._UZ(2,"input",59),e.TgZ(3,"label",60),e._uU(4),e.qZA(),e.qZA(),e.qZA()),2&o){const t=n.$implicit,a=n.index;e.Q6J("ngClass",e.VKq(5,Ce,"*"==t)),e.xp6(2),e.Q6J("id",t)("formControlName",a),e.xp6(1),e.Q6J("for",t),e.xp6(1),e.hij(" ","*"==t?"Select all resources":t," ")}}function De(o,n){if(1&o&&(e.TgZ(0,"div",27),e.TgZ(1,"div",53),e.TgZ(2,"div",54),e._UZ(3,"input",55),e.TgZ(4,"label",56),e._uU(5," Select all resources "),e.qZA(),e.qZA(),e.qZA(),e.YNc(6,qe,5,7,"div",57),e.qZA()),2&o){const t=e.oxw();e.xp6(6),e.Q6J("ngForOf",null==t.serviceFormGroup.value.service?null:t.serviceFormGroup.value.service.resources)}}function Ne(o,n){1&o&&e._uU(0,"Tags")}function Je(o,n){1&o&&(e.TgZ(0,"div"),e._uU(1," Key can contain alphanumeric characters, or any of the following: _.:/=+-@ "),e.qZA())}function Se(o,n){if(1&o&&(e.TgZ(0,"div",70),e.YNc(1,Je,2,0,"div",18),e.qZA()),2&o){e.oxw();const t=e.MAs(3);e.xp6(1),e.Q6J("ngIf",null==t.errors?null:t.errors.pattern)}}function Qe(o,n){1&o&&(e.TgZ(0,"div"),e._uU(1," Value can contain alphanumeric characters, or any of the following: _.:/=+-@ "),e.qZA())}function Ie(o,n){if(1&o&&(e.TgZ(0,"div",70),e.YNc(1,Qe,2,0,"div",18),e.qZA()),2&o){e.oxw();const t=e.MAs(7);e.xp6(1),e.Q6J("ngIf",null==t.errors?null:t.errors.pattern)}}function Pe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw().addTag(i)}),e._UZ(1,"i",72),e._uU(2," Add tag "),e.qZA()}if(2&o){const t=e.oxw().$implicit,a=e.MAs(3),i=e.MAs(7),r=e.oxw();e.Q6J("disabled",!(!r.core.isEmptyOrNull(t.key)&&a.valid)||i.invalid)}}function ke(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"i",73),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw().removeTag(i)}),e.qZA()}}const k=function(){return{standalone:!0}},M=function(o){return{validateInput:o}};function Me(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td",44),e.TgZ(2,"input",61,62),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.key=i}),e.qZA(),e.YNc(4,Se,2,1,"div",63),e.qZA(),e.TgZ(5,"td",64),e.TgZ(6,"input",65,66),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.value=i}),e.qZA(),e.YNc(8,Ie,2,1,"div",63),e.qZA(),e.TgZ(9,"td",67),e.YNc(10,Pe,3,1,"button",68),e.YNc(11,ke,1,0,"i",69),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit,a=n.index,i=e.MAs(3),r=e.MAs(7),l=e.oxw();e.xp6(2),e.Q6J("ngModel",t.key)("ngModelOptions",e.DdM(14,k))("pattern",l.core.tagPatten)("disabled",t.disabled)("ngClass",e.VKq(15,M,i.dirty&&i.invalid)),e.xp6(2),e.Q6J("ngIf",i.invalid),e.xp6(2),e.Q6J("ngModel",t.value)("ngModelOptions",e.DdM(17,k))("pattern",l.core.tagPatten)("disabled",t.disabled)("ngClass",e.VKq(18,M,r.dirty&&r.invalid)),e.xp6(2),e.Q6J("ngIf",r.invalid),e.xp6(2),e.Q6J("ngIf",l.tags.length-1===a),e.xp6(1),e.Q6J("ngIf",l.tags.length-1!==a)}}function Ge(o,n){1&o&&e._uU(0,"Summary")}function Re(o,n){if(1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"td",74),e._uU(2),e.qZA(),e.TgZ(3,"td",74),e._uU(4),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(2),e.hij(" ",t.key," "),e.xp6(2),e.hij(" ",t.value," ")}}function Oe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",75),e.NdJ("click",function(){return e.CHM(t),e.oxw(),e.MAs(18).previous()}),e._uU(1," Previous "),e.qZA()}}function Fe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",76),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(18);return i.nextStep(r)}),e._uU(1," Next: Tags "),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.serviceFormGroup.invalid)}}function Le(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",77),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(18);return i.nextStep(r)}),e._uU(1," Next: Summary "),e.qZA()}}function Ee(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",76),e.NdJ("click",function(){return e.CHM(t),e.oxw().createPolicy()}),e._uU(1," Create policy "),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.policyDetailsFormGroup.invalid)}}const Ye=function(){return["/console/idap/dashboard"]},G=function(){return["/console/idap/policies"]},Ke=function(o,n){return{"fa-caret-right":o,"fa-caret-down":n}},je=function(){return[]};let He=(()=>{class o{constructor(t,a,i,r,l){this.core=t,this.idapService=a,this.fb=i,this.router=r,this.loadingData=!1,this.isServiceCollapsed=!1,this.services=[],this.resourcesInUse=[],this.selectedResources=[],this.isLinear=!0,this.tags=[{key:"",value:"",disabled:!1}],this.tempLocalStorageKeys=["policy-service-data","policy-details-data"],this.stepperOrientation=l.observe("(min-width: 600px)").pipe((0,b.U)(({matches:d})=>d?"horizontal":"vertical"))}ngOnInit(){this.initServiceForm(),this.loadServiceForm(),this.initPolicyForm(),this.getServices(),this.serviceFormGroup.controls.resourceArray.valueChanges.subscribe(t=>{t.forEach((a,i)=>{if(0===i&&a)this.selectedResources=[],this.selectedResources.push("*");else if(0!==i||a){if(a)this.selectedResources.push(this.resourcesInUse[i]);else if(!a){let r=this.selectedResources.findIndex(l=>l===this.resourcesInUse[i]);-1!=r&&this.selectedResources.splice(r,1)}}else this.selectedResources=[];this.serviceFormGroup.controls.resources.setValue(this.selectedResources)})}),this.serviceFormGroup.controls.allResources.valueChanges.subscribe(t=>{if(1==t){this.resourcesFormArray.controls[0].setValue(t);for(let a=1;a<this.resourcesFormArray.controls.length;a++)this.resourcesFormArray.controls[a].setValue(t),this.resourcesFormArray.controls[a].disable()}else{this.resourcesFormArray.controls[0].setValue(t);for(let a=1;a<this.resourcesFormArray.controls.length;a++)this.resourcesFormArray.controls[a].enable(),this.resourcesFormArray.controls[a].setValue(t)}})}ngAfterViewInit(){let t;this.core.isEmptyOrNull(localStorage.getItem(this.tempLocalStorageKeys[1]))?this.core.isEmptyOrNull(localStorage.getItem(this.tempLocalStorageKeys[0]))||(t=JSON.parse(localStorage.getItem(this.tempLocalStorageKeys[0])),this.stepper.selectedIndex=null!=t||null!=t?t.completedStep+1:0):(t=JSON.parse(localStorage.getItem(this.tempLocalStorageKeys[1])),this.stepper.selectedIndex=null!=t||null!=t?t.completedStep:0,this.stepper.selectedIndex=null!=t||null!=t?t.completedStep+1:0)}initServiceForm(){this.serviceFormGroup=this.fb.group({service:["",s.kI.required],allResources:[],resources:["",s.kI.required],resourceArray:new s.Oe([]),tags:[]})}loadServiceForm(){if(!this.core.isEmptyOrNull(localStorage.getItem(this.tempLocalStorageKeys[0]))){let t=JSON.parse(localStorage.getItem(this.tempLocalStorageKeys[0]));t.resourceArray.forEach(a=>this.resourcesFormArray.push(new s.NI(a))),this.resourcesInUse=t.service.resources,this.tags=null==t.tags||0==t.tags.length?[{key:"",value:"",disabled:!1}]:t.tags,this.serviceFormGroup.patchValue({service:t.service,allResources:t.allResources,resources:t.resources,tags:t.tags})}}initPolicyForm(){this.policyDetailsFormGroup=this.fb.group({policyName:["",s.kI.compose([s.kI.required,s.kI.maxLength(128),s.kI.minLength(3)])],description:["",s.kI.compose([s.kI.maxLength(1e3),s.kI.minLength(3)])]})}get resourcesFormArray(){return this.serviceFormGroup.controls.resourceArray}selectService(t){this.serviceFormGroup.controls.service.setValue(t),this.resourcesInUse=t.resources,this.isServiceCollapsed=!this.isServiceCollapsed,this.resourcesFormArray.clear(),this.serviceFormGroup.value.service.resources.forEach(()=>this.resourcesFormArray.push(new s.NI(!1)))}addTag(t){this.tags[t].disabled=!0,this.tags.push({key:"",value:"",disabled:!1})}removeTag(t){this.tags.splice(t,1)}createPolicy(){var t=this;return(0,_.Z)(function*(){try{t.loadingData=!0;let a={policyName:t.policyDetailsFormGroup.value.policyName,description:t.policyDetailsFormGroup.value.description,policyDocument:{actions:[{service:t.serviceFormGroup.value.service.service,resources:t.serviceFormGroup.value.resources}],effect:"allow"},tags:t.serviceFormGroup.value.tags};yield t.idapService.createPolicy(a),t.loadingData=!1,t.router.navigate(["/console/idap/policies"])}catch(a){t.loadingData=!1}})()}getServices(){this.loadingData=!0,this.idapService.getServices().then(t=>{this.loadingData=!1,this.services=t.data.actions}).catch(()=>{this.loadingData=!1})}nextStep(t){if(0==t.selectedIndex)localStorage.setItem(this.tempLocalStorageKeys[0],JSON.stringify(Object.assign(Object.assign({},this.serviceFormGroup.getRawValue()),{completedStep:t.selectedIndex}))),t.next();else if(1==t.selectedIndex){let a=this.core._lodashRef.cloneDeep(this.tags);a.splice(a.length-1,1),a.map(i=>{this.core.sanitiseRequestObject(i,"","disabled")}),this.serviceFormGroup.controls.tags.setValue([...a]),localStorage.setItem(this.tempLocalStorageKeys[0],JSON.stringify(Object.assign(Object.assign({},this.serviceFormGroup.getRawValue()),{completedStep:t.selectedIndex}))),t.next()}else this.serviceFormGroup.reset(),this.policyDetailsFormGroup.reset(),t.reset(),this.tempLocalStorageKeys.forEach(a=>{localStorage.removeItem(a)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.p),e.Y36(f.t),e.Y36(s.qu),e.Y36(p.F0),e.Y36(I))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-policy"]],viewQuery:function(t,a){if(1&t&&e.Gf(we,5),2&t){let i;e.iGM(i=e.CRH())&&(a.stepper=i.first)}},decls:138,vars:33,consts:[[1,"container-fluid"],[3,"routerLink"],[1,"fa","fa-chevron-right"],[1,"row","pt-3","align-items-center"],[1,"col"],[1,"row","mat-typography"],["labelPosition","bottom",3,"linear","orientation"],["stepper",""],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],[1,"mb-1","mt-3","fw-bold"],[1,"mt-1"],[1,"row","justify-content-center","align-items-center","pt-2","pb-2","row-selector"],["type","button","aria-controls","mobileContent","aria-label","Toggle navigation",1,"col","col-sm-4","d-sm-flex","justify-content-sm-end",3,"click"],[1,"fa","fa-lg","align-self-center","pe-2",3,"ngClass"],[1,"form-label","fw-bold"],[1,"col","col-sm-8"],[4,"ngIf"],["id","selectService",3,"ngbCollapse","ngbCollapseChange"],[1,"d-flex","flex-row"],["class","me-4 text-button",3,"click",4,"ngFor","ngForOf"],[1,"row","justify-content-center","pt-2","pb-2","row-selector"],[1,"col","col-sm-4","d-sm-flex","justify-content-sm-end"],["for","groupName",1,"form-label","fw-bold","mt-0"],["class","row",4,"ngIf"],[1,"mt-1","mb-1"],[1,"row"],[1,"col","table-responsive","pb-2"],[1,"table","mb-1"],[1,"table-light"],["scope","col"],["scope","col",1,"text-center"],[4,"ngFor","ngForOf"],[1,"col","col-sm-3","d-flex","justify-content-end"],["for","policyName",1,"form-label","fw-bold"],[1,"col","col-sm-5"],["type","text","id","policyName","formControlName","policyName",1,"form-control","form-control-sm"],[1,"form-text"],[1,"row","mt-3"],["for","description",1,"form-label","fw-bold"],[1,"col","col-sm-9"],["id","description","rows","2","formControlName","description",1,"form-control","form-control-sm"],[1,"row","mt-4"],["width","20%"],[1,"mt-4"],[1,"fw-bold"],[1,"col","d-flex","justify-content-end","align-items-center"],["class","btn btn-sm btn-secondary ms-3",3,"click",4,"ngIf"],["class","btn btn-sm btn-custom-secondary ms-3",3,"disabled","click",4,"ngIf"],["class","btn btn-sm btn-custom-secondary ms-3",3,"click",4,"ngIf"],[3,"show"],[1,"me-4","text-button",3,"click"],[1,"col-12"],[1,"form-check"],["type","checkbox","id","allResources","formControlName","allResources",1,"form-check-input"],["for","allResources",1,"form-check-label"],["class","col-4","formArrayName","resourceArray",3,"ngClass",4,"ngFor","ngForOf"],["formArrayName","resourceArray",1,"col-4",3,"ngClass"],["type","checkbox",1,"form-check-input",3,"id","formControlName"],[1,"form-check-label",3,"for"],["type","text","placeholder","Add new key",1,"form-control","form-control-sm",3,"ngModel","ngModelOptions","pattern","disabled","ngClass","ngModelChange"],["key","ngModel"],["class","invalid-feedback d-block",4,"ngIf"],["width","68%"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelOptions","pattern","disabled","ngClass","ngModelChange"],["value","ngModel"],[1,"text-center","align-middle"],["class","btn btn-sm btn-custom-primary",3,"disabled","click",4,"ngIf"],["class","fas fa-times",3,"click",4,"ngIf"],[1,"invalid-feedback","d-block"],[1,"btn","btn-sm","btn-custom-primary",3,"disabled","click"],[1,"fas","fa-plus"],[1,"fas","fa-times",3,"click"],["width","50%"],[1,"btn","btn-sm","btn-secondary","ms-3",3,"click"],[1,"btn","btn-sm","btn-custom-secondary","ms-3",3,"disabled","click"],[1,"btn","btn-sm","btn-custom-secondary","ms-3",3,"click"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"a",1),e._uU(3,"IDAP"),e.qZA(),e._uU(4," \xa0 "),e._UZ(5,"i",2),e._uU(6," \xa0 "),e.TgZ(7,"a",1),e._uU(8,"Policies"),e.qZA(),e._uU(9," \xa0 "),e._UZ(10,"i",2),e._uU(11," \xa0 Create policy "),e.qZA(),e.TgZ(12,"div",3),e.TgZ(13,"div",4),e.TgZ(14,"h3"),e._uU(15,"Create policy"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",5),e.TgZ(17,"mat-stepper",6,7),e.ALo(19,"async"),e.TgZ(20,"mat-step",8),e.TgZ(21,"form",9),e.YNc(22,Ae,1,0,"ng-template",10),e.TgZ(23,"h4",11),e._uU(24,"Set policy service details"),e.qZA(),e._UZ(25,"hr",12),e.TgZ(26,"div",13),e.TgZ(27,"div",14),e.NdJ("click",function(){return a.isServiceCollapsed=!a.isServiceCollapsed}),e._UZ(28,"i",15),e.TgZ(29,"label",16),e._uU(30,"Service"),e.TgZ(31,"span"),e._uU(32,"*"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(33,"div",17),e.YNc(34,ye,2,1,"span",18),e.TgZ(35,"div",19),e.NdJ("ngbCollapseChange",function(r){return!(a.isServiceCollapsed=r)}),e.TgZ(36,"div",20),e.YNc(37,be,2,1,"a",21),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(38,"div",22),e.TgZ(39,"div",23),e.TgZ(40,"label",24),e._uU(41,"Resources"),e.TgZ(42,"span"),e._uU(43,"*"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(44,"div",17),e.YNc(45,Ue,2,0,"span",18),e.YNc(46,De,7,1,"div",25),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(47,"mat-step"),e.YNc(48,Ne,1,0,"ng-template",10),e.TgZ(49,"h4",11),e._uU(50,"Add tags"),e.qZA(),e._UZ(51,"hr",26),e.TgZ(52,"div",27),e.TgZ(53,"p"),e._uU(54,"IDAP tags are key-value pairs you can add to your user. Tags can include user information, such as an email address, or can be descriptive, such as a job title. You can use the tags to organize, track, or control access for this user."),e.qZA(),e.TgZ(55,"div",28),e.TgZ(56,"table",29),e.TgZ(57,"thead",30),e.TgZ(58,"tr"),e.TgZ(59,"th",31),e._uU(60,"Key*"),e.qZA(),e.TgZ(61,"th",31),e._uU(62,"Value"),e.qZA(),e.TgZ(63,"th",32),e._uU(64,"Action"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(65,"tbody"),e.YNc(66,Me,12,20,"tr",33),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(67,"mat-step"),e.YNc(68,Ge,1,0,"ng-template",10),e.TgZ(69,"form",9),e.TgZ(70,"h4",11),e._uU(71,"Policy summary"),e.qZA(),e._UZ(72,"hr",12),e.TgZ(73,"div",27),e.TgZ(74,"div",34),e.TgZ(75,"label",35),e._uU(76,"Policy name"),e.TgZ(77,"span"),e._uU(78,"*"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(79,"div",36),e._UZ(80,"input",37),e.TgZ(81,"small",38),e._uU(82," Maximum 128 characters. Use alphanumeric and '+=,.@-_' characters. "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(83,"div",39),e.TgZ(84,"div",34),e.TgZ(85,"label",40),e._uU(86,"Policy description"),e.qZA(),e.qZA(),e.TgZ(87,"div",41),e._UZ(88,"textarea",42),e.TgZ(89,"small",38),e._uU(90," Maximum 1000 characters. Use alphanumeric and '+=,.@-_' characters. "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(91,"div",43),e.TgZ(92,"div",34),e.TgZ(93,"label",40),e._uU(94,"Summary"),e.qZA(),e.qZA(),e.TgZ(95,"div",41),e.TgZ(96,"div",28),e.TgZ(97,"table",29),e.TgZ(98,"thead",30),e.TgZ(99,"tr"),e.TgZ(100,"th",31),e._uU(101,"Service"),e.qZA(),e.TgZ(102,"th",31),e._uU(103,"Resources"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(104,"tbody"),e.TgZ(105,"tr"),e.TgZ(106,"td",44),e._uU(107),e.qZA(),e.TgZ(108,"td"),e._uU(109),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(110,"div",43),e.TgZ(111,"div",34),e.TgZ(112,"label",40),e._uU(113,"Tags"),e.qZA(),e.qZA(),e.TgZ(114,"div",41),e.TgZ(115,"div",28),e.TgZ(116,"table",29),e.TgZ(117,"thead",30),e.TgZ(118,"tr"),e.TgZ(119,"th",31),e._uU(120,"Key"),e.qZA(),e.TgZ(121,"th",31),e._uU(122,"Value"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(123,"tbody"),e.YNc(124,Re,5,2,"tr",33),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(125,"hr",45),e.TgZ(126,"div",27),e.TgZ(127,"div",4),e.TgZ(128,"span",46),e._uU(129,"* Required"),e.qZA(),e.qZA(),e.TgZ(130,"div",47),e.TgZ(131,"a",1),e._uU(132,"Close"),e.qZA(),e.YNc(133,Oe,2,0,"button",48),e.YNc(134,Fe,2,1,"button",49),e.YNc(135,Le,2,0,"button",50),e.YNc(136,Ee,2,1,"button",49),e.qZA(),e.qZA(),e.qZA(),e._UZ(137,"ngx-loading",51)),2&t){const i=e.MAs(18);e.xp6(2),e.Q6J("routerLink",e.DdM(26,Ye)),e.xp6(5),e.Q6J("routerLink",e.DdM(27,G)),e.xp6(10),e.Q6J("linear",a.isLinear)("orientation",e.lcZ(19,24,a.stepperOrientation)),e.xp6(3),e.Q6J("stepControl",a.serviceFormGroup),e.xp6(1),e.Q6J("formGroup",a.serviceFormGroup),e.xp6(6),e.uIk("aria-expanded",a.isServiceCollapsed),e.xp6(1),e.Q6J("ngClass",e.WLB(28,Ke,!a.isServiceCollapsed,a.isServiceCollapsed)),e.xp6(6),e.Q6J("ngIf",!a.isServiceCollapsed),e.xp6(1),e.Q6J("ngbCollapse",!a.isServiceCollapsed),e.xp6(2),e.Q6J("ngForOf",a.services),e.xp6(8),e.Q6J("ngIf",a.core.isEmptyOrNull(a.serviceFormGroup.value.service)),e.xp6(1),e.Q6J("ngIf",!a.core.isEmptyOrNull(a.serviceFormGroup.value.service)),e.xp6(20),e.Q6J("ngForOf",a.tags),e.xp6(3),e.Q6J("formGroup",a.policyDetailsFormGroup),e.xp6(38),e.hij(" ",null==a.serviceFormGroup.value.service?null:a.serviceFormGroup.value.service.service," "),e.xp6(2),e.hij(" [",a.serviceFormGroup.value.resources,"] "),e.xp6(15),e.Q6J("ngForOf",a.serviceFormGroup.value.tags||e.DdM(31,je)),e.xp6(7),e.Q6J("routerLink",e.DdM(32,G)),e.xp6(2),e.Q6J("ngIf",0!=i.selectedIndex),e.xp6(1),e.Q6J("ngIf",0==i.selectedIndex),e.xp6(1),e.Q6J("ngIf",1==i.selectedIndex),e.xp6(1),e.Q6J("ngIf",2==i.selectedIndex),e.xp6(1),e.Q6J("show",a.loadingData)}},directives:[p.yS,w.Vq,w.C0,s._Y,s.JL,s.sg,w.VY,m.mk,m.O5,g._D,m.sg,s.Wl,s.JJ,s.u,s.CE,s.Fj,s.On,s.c5,Z.RJ],pipes:[m.Ov],styles:[".row-selector[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{margin-top:.5rem}"]}),o})();var T=u(4539),c=u(7805),v=u(9828);function ze(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",5),e.TgZ(1,"button",14),e.NdJ("click",function(){return e.CHM(t),e.oxw().getPolicies()}),e._UZ(2,"i",15),e.qZA(),e.qZA()}}function We(o,n){if(1&o&&(e.TgZ(0,"span",35),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij("",null==t.selectedRows?null:t.selectedRows.length," selected")}}const Be=function(o){return["../policies/details",o]};function Ve(o,n){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"a",1),e._uU(2),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,Be,t.data.policyId)),e.xp6(1),e.Oqu(t.data.policyName)}}function $e(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(2);e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.createDate)," ")}}function Xe(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(2);e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.updateDate)," ")}}const et=function(){return{groupPaging:!1}},tt=function(){return[10,20,30,40,50]};function ot(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",16),e.TgZ(2,"button",17),e._uU(3,"Delete"),e.qZA(),e.YNc(4,We,2,1,"span",18),e.qZA(),e.TgZ(5,"dx-data-grid",19,20),e.NdJ("selectedRowKeysChange",function(i){return e.CHM(t),e.oxw().selectedRows=i}),e._UZ(7,"dxo-paging",21),e._UZ(8,"dxo-pager",22),e._UZ(9,"dxo-load-panel",23),e._UZ(10,"dxo-search-panel",24),e._UZ(11,"dxo-selection",25),e._UZ(12,"dxi-column",26),e._UZ(13,"dxi-column",27),e._uU(14,"isAttachable "),e._UZ(15,"dxi-column",28),e._UZ(16,"dxi-column",29),e._UZ(17,"dxi-column",30),e._UZ(18,"dxi-column",31),e.YNc(19,Ve,3,4,"div",32),e.YNc(20,$e,2,1,"div",32),e.YNc(21,Xe,2,1,"div",32),e._UZ(22,"dxo-export",33),e._UZ(23,"dxo-column-chooser",34),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("disabled",0==(null==t.selectedRows?null:t.selectedRows.length)),e.xp6(2),e.Q6J("ngIf",null==t.selectedRows?null:t.selectedRows.length),e.xp6(1),e.Q6J("dataSource",t.policies)("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0)("selectedRowKeys",t.selectedRows),e.xp6(2),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(31,et)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(32,tt))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(2),e.Q6J("visible",!1),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(3),e.Q6J("allowHiding",!1),e.xp6(3),e.Q6J("dxTemplateOf","userNameTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","createDateTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","updateDateTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}function at(o,n){if(1&o&&(e.TgZ(0,"div",36),e.TgZ(1,"h4",37),e._uU(2,"Unauthorised action"),e.qZA(),e.TgZ(3,"p"),e._uU(4),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(4),e.Oqu(t.unauthorisedDashboard.description)}}const nt=function(){return["../dashboard"]},it=function(){return["../policies/create"]};let rt=(()=>{class o{constructor(t,a){this.core=t,this.idapService=a,this.policies=[],this.loadingData=!1,this.unauthorisedDashboard={authorised:!0,description:""},this.selectedRows=[]}ngOnInit(){this.getPolicies()}getPolicies(){this.loadingData=!0,this.idapService.getPolicies().then(t=>{this.loadingData=!1,this.unauthorisedDashboard.authorised=!0,this.policies=t.data.policies}).catch(t=>{this.loadingData=!1,this.unauthorisedDashboard=this.core.getUnauthorisedErrorMessage(t)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.p),e.Y36(f.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-policies"]],decls:25,vars:9,consts:[[1,"container-fluid"],[3,"routerLink"],[1,"fa","fa-chevron-right"],[1,"row"],[1,"col"],[1,"col","d-flex","justify-content-end"],[1,"text-muted"],[1,"pt-3"],[1,"row","pb-2"],[1,"btn","btn-sm","btn-custom-secondary",3,"routerLink"],["class","col d-flex justify-content-end",4,"ngIf"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[3,"show"],["title","Refresh",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fas","fa-sync-alt"],[1,"add-datagrid-buttons"],[1,"btn","btn-sm","btn-danger",3,"disabled"],["class","selection-count text-muted",4,"ngIf"],["noDataText","No data available",3,"dataSource","columnAutoWidth","showBorders","showRowLines","showColumnLines","allowColumnReordering","wordWrapEnabled","selectedRowKeys","selectedRowKeysChange"],["usersContainer",""],[3,"enabled","pageSize","remoteOperations"],[3,"showPageSizeSelector","allowedPageSizes","showInfo"],[3,"height","width","showPane","shading"],["placeholder","Search...",3,"visible","width"],["selectAllMode","allPages","showCheckBoxesMode","always","mode","multiple"],["dataField","policyId",3,"visible"],["dataField","policyName","caption","Policy name","cellTemplate","userNameTemplate",3,"allowHiding"],["dataField","isAttachable"],["dataField","description",3,"allowHiding"],["dataField","createDate","caption","Created at","cellTemplate","createDateTemplate"],["dataField","updateDate","caption","Updated at","cellTemplate","updateDateTemplate"],[4,"dxTemplate","dxTemplateOf"],["fileName","Policies",3,"enabled","allowExportSelectedData"],[3,"enabled"],[1,"selection-count","text-muted"],[1,"alert","alert-danger"],[1,"alert-heading"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"a",1),e._uU(3,"IDAP"),e.qZA(),e._uU(4," \xa0 "),e._UZ(5,"i",2),e._uU(6," \xa0 Policies "),e.qZA(),e._UZ(7,"hr"),e.TgZ(8,"div",3),e.TgZ(9,"div",4),e.TgZ(10,"h4"),e._uU(11,"Policies"),e.qZA(),e.qZA(),e.TgZ(12,"div",5),e.TgZ(13,"span",6),e._uU(14),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"div",7),e.TgZ(16,"div",8),e.TgZ(17,"div",4),e.TgZ(18,"button",9),e._uU(19,"Create policy"),e.qZA(),e.qZA(),e.YNc(20,ze,3,0,"div",10),e.qZA(),e.YNc(21,ot,24,33,"ng-container",11),e.YNc(22,at,5,1,"ng-template",null,12,e.W1O),e.qZA(),e.qZA(),e._UZ(24,"ngx-loading",13)),2&t){const i=e.MAs(23);e.xp6(2),e.Q6J("routerLink",e.DdM(7,nt)),e.xp6(12),e.hij("Total: ",a.policies.length,""),e.xp6(4),e.Q6J("routerLink",e.DdM(8,it)),e.xp6(2),e.Q6J("ngIf",a.unauthorisedDashboard.authorised),e.xp6(1),e.Q6J("ngIf",a.unauthorisedDashboard.authorised)("ngIfElse",i),e.xp6(3),e.Q6J("show",a.loadingData)}},directives:[p.yS,p.rH,m.O5,T.e,c.sXh,c.ilc,c.mKI,c.XXE,c.Lz9,c.qvW,v.p6,c.Ak0,c.Auv,Z.RJ],styles:[""]}),o})();function st(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",null==t.data.resources?null:t.data.resources.toString()," ")}}const R=function(){return[]},U=function(){return{groupPaging:!1}},C=function(){return[10,20,30,40,50]};function lt(o,n){if(1&o&&(e.TgZ(0,"div",19),e.TgZ(1,"dx-data-grid",20),e._UZ(2,"dxo-paging",21),e._UZ(3,"dxo-pager",22),e._UZ(4,"dxo-load-panel",23),e._UZ(5,"dxo-search-panel",24),e._UZ(6,"dxi-column",25),e._UZ(7,"dxi-column",26),e.YNc(8,st,2,1,"div",27),e._UZ(9,"dxo-export",28),e._UZ(10,"dxo-column-chooser",29),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",(null==t.policyData||null==t.policyData.policyDocument?null:t.policyData.policyDocument.actions)||e.DdM(24,R))("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0),e.xp6(1),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(25,U)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(26,C))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("dxTemplateOf","resourcesTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}function ct(o,n){if(1&o&&(e.TgZ(0,"span",41),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij("",null==t.selectedGroupsRows?null:t.selectedGroupsRows.length," selected")}}function dt(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e._UZ(2,"i",42),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.column.caption,"\xa0")}}const ut=function(o){return[o]};function pt(o,n){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"a",43),e._uU(2),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,ut,"/console/idap/user-groups/details/"+t.data.groupName)),e.xp6(1),e.Oqu(t.data.groupName)}}function gt(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(2);e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.createDate)," ")}}const mt=function(o){return["/console/idap/policies/details/",o,"add","groups"]};function _t(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",19),e.TgZ(1,"div",30),e.TgZ(2,"div",4),e.TgZ(3,"button",31),e._uU(4," Attach groups "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(5,"span",32),e.TgZ(6,"button",33),e.NdJ("click",function(){return e.CHM(t),e.oxw().detachPolicies()}),e._uU(7,"Detach"),e.qZA(),e.YNc(8,ct,2,1,"span",34),e.qZA(),e.TgZ(9,"dx-data-grid",35),e.NdJ("selectedRowKeysChange",function(i){return e.CHM(t),e.oxw().selectedGroupsRows=i}),e._UZ(10,"dxo-paging",21),e._UZ(11,"dxo-pager",22),e._UZ(12,"dxo-load-panel",23),e._UZ(13,"dxo-search-panel",24),e._UZ(14,"dxo-selection",36),e._UZ(15,"dxi-column",37),e._UZ(16,"dxi-column",38),e._UZ(17,"dxi-column",39),e.YNc(18,dt,3,1,"div",27),e.YNc(19,pt,3,4,"div",27),e.YNc(20,gt,2,1,"div",27),e._UZ(21,"dxo-export",40),e._UZ(22,"dxo-column-chooser",29),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("routerLink",e.VKq(31,mt,t.policyId)),e.xp6(3),e.Q6J("disabled",0==(null==t.selectedGroupsRows?null:t.selectedGroupsRows.length)),e.xp6(2),e.Q6J("ngIf",null==t.selectedGroupsRows?null:t.selectedGroupsRows.length),e.xp6(1),e.Q6J("dataSource",t.policyGroups)("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0)("selectedRowKeys",t.selectedGroupsRows),e.xp6(1),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(33,U)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(34,C))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(2),e.Q6J("visible",!1),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("dxTemplateOf","groupHeaderTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","groupTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","createDateTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}function ht(o,n){if(1&o&&(e.TgZ(0,"div",19),e.TgZ(1,"dx-data-grid",20),e._UZ(2,"dxo-paging",21),e._UZ(3,"dxo-pager",22),e._UZ(4,"dxo-load-panel",23),e._UZ(5,"dxo-search-panel",24),e._UZ(6,"dxi-column",44),e._UZ(7,"dxi-column",45),e._UZ(8,"dxo-export",46),e._UZ(9,"dxo-column-chooser",29),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",(null==t.policyData?null:t.policyData.tags)||e.DdM(23,R))("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0),e.xp6(1),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(24,U)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(25,C))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}const Zt=function(){return["/console/idap/dashboard"]},ft=function(){return["/console/idap/policies"]};let xt=(()=>{class o{constructor(t,a,i){this.core=t,this.route=a,this.idapService=i,this.policyId="",this.policyData=void 0,this.policySummary=void 0,this.policyGroups=[],this.selectedGroupsRows=[],this.loadingData=!1}ngOnInit(){this.policyId=this.route.snapshot.paramMap.get("policyId"),this.getPolicyDetails(this.policyId)}getPolicyDetails(t){this.loadingData=!0,this.idapService.getPolicy(t).then(a=>{this.policyData=a.data.policy,this.policyGroups=a.data.groups,this.policySummary=a.data.summary,this.loadingData=!1}).catch(a=>{this.loadingData=!1})}detachPolicies(){var t=this;if(confirm("Are you sure you want to detach groups")){this.loadingData=!0;let i=[],r=[];this.selectedGroupsRows.forEach(function(){var l=(0,_.Z)(function*(d){try{yield t.idapService.detachPolicies(t.policyId,d.groupName),i.push([d.groupName]),t.selectedGroupsRows.length==i.length&&(t.core.successToast("Groups successfully detached"),t.loadingData=!1,t.getPolicyDetails(t.policyId))}catch(x){r.push([d.groupName]),t.core.errorToast("Error detaching group: "+d.groupName),t.loadingData=!1}});return function(d){return l.apply(this,arguments)}}())}}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.p),e.Y36(p.gz),e.Y36(f.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-policy-details"]],decls:55,vars:15,consts:[[1,"container-fluid"],[3,"routerLink"],[1,"fa","fa-chevron-right"],[1,"row","pt-3","align-items-center"],[1,"col"],[1,""],[1,"col","d-flex","justify-content-end"],[1,"btn","btn-sm","btn-danger"],[1,"col-12","col-sm-8"],[1,"row"],[1,"col-4","col-sm","d-flex","justify-content-sm-end"],[1,"btn","btn-sm","btn-secondary"],["ngbNav","",1,"nav-pills","pt-3"],["nav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2",3,"ngbNavOutlet"],[3,"show"],[1,"pt-3"],["noDataText","No data available",3,"dataSource","columnAutoWidth","showBorders","showRowLines","showColumnLines","allowColumnReordering","wordWrapEnabled"],[3,"enabled","pageSize","remoteOperations"],[3,"showPageSizeSelector","allowedPageSizes","showInfo"],[3,"height","width","showPane","shading"],["placeholder","Search...",3,"visible","width"],["dataField","service",3,"allowHiding"],["dataField","resources","cellTemplate","resourcesTemplate"],[4,"dxTemplate","dxTemplateOf"],["fileName","Policy documents",3,"enabled","allowExportSelectedData"],[3,"enabled"],[1,"row","pb-1"],[1,"btn","btn-sm","btn-custom-secondary",3,"routerLink"],[1,"add-datagrid-buttons"],[1,"btn","btn-sm","btn-danger",3,"disabled","click"],["class","selection-count text-muted",4,"ngIf"],["noDataText","No data available",3,"dataSource","columnAutoWidth","showBorders","showRowLines","showColumnLines","allowColumnReordering","wordWrapEnabled","selectedRowKeys","selectedRowKeysChange"],["selectAllMode","allPages","showCheckBoxesMode","always","mode","multiple"],["dataField","groupId",3,"visible"],["dataField","groupName","caption","Group name","headerCellTemplate","groupHeaderTemplate","cellTemplate","groupTemplate",3,"allowHiding"],["dataField","createDate","caption","Created at","cellTemplate","createDateTemplate"],["fileName","Group policies",3,"enabled","allowExportSelectedData"],[1,"selection-count","text-muted"],[1,"fa","fa-sm","fa-external-link-alt"],["target","_blank",3,"routerLink"],["dataField","key",3,"allowHiding"],["dataField","value"],["fileName","Policy tags",3,"enabled","allowExportSelectedData"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"a",1),e._uU(3,"IDAP"),e.qZA(),e._uU(4," \xa0 "),e._UZ(5,"i",2),e._uU(6," \xa0 "),e.TgZ(7,"a",1),e._uU(8,"Policies"),e.qZA(),e._uU(9," \xa0 "),e._UZ(10,"i",2),e._uU(11),e.qZA(),e.TgZ(12,"div",3),e.TgZ(13,"div",4),e.TgZ(14,"h3",5),e._uU(15),e.qZA(),e.qZA(),e.TgZ(16,"div",6),e.TgZ(17,"button",7),e._uU(18,"Delete"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",3),e.TgZ(20,"div",4),e.TgZ(21,"h5"),e._uU(22,"Summary"),e.qZA(),e.qZA(),e.TgZ(23,"div",8),e.TgZ(24,"div",9),e.TgZ(25,"div",10),e.TgZ(26,"span"),e._uU(27,"Creation time:"),e.qZA(),e.qZA(),e.TgZ(28,"div",4),e._uU(29),e.qZA(),e.qZA(),e.TgZ(30,"div",9),e.TgZ(31,"div",10),e.TgZ(32,"span"),e._uU(33,"Description:"),e.qZA(),e.qZA(),e.TgZ(34,"div",4),e._uU(35),e.qZA(),e.qZA(),e.qZA(),e.TgZ(36,"div",6),e.TgZ(37,"button",11),e._uU(38,"Edit"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(39,"nav",12,13),e.ynx(41,14),e.TgZ(42,"a",15),e._uU(43,"Policy documents"),e.qZA(),e.YNc(44,lt,11,27,"ng-template",16),e.BQk(),e.ynx(45,14),e.TgZ(46,"a",15),e._uU(47),e.qZA(),e.YNc(48,_t,23,35,"ng-template",16),e.BQk(),e.ynx(49,14),e.TgZ(50,"a",15),e._uU(51),e.qZA(),e.YNc(52,ht,10,26,"ng-template",16),e.BQk(),e.qZA(),e._UZ(53,"div",17),e.qZA(),e._UZ(54,"ngx-loading",18)),2&t){const i=e.MAs(40);e.xp6(2),e.Q6J("routerLink",e.DdM(13,Zt)),e.xp6(5),e.Q6J("routerLink",e.DdM(14,ft)),e.xp6(4),e.hij(" \xa0 ",null==a.policyData?null:a.policyData.policyName," "),e.xp6(4),e.Oqu(null==a.policyData?null:a.policyData.policyName),e.xp6(14),e.hij(" ",a.core.getDate(null==a.policyData?null:a.policyData.createDate)," "),e.xp6(6),e.hij(" ",null==a.policyData?null:a.policyData.description," "),e.xp6(6),e.Q6J("ngbNavItem",1),e.xp6(4),e.Q6J("ngbNavItem",2),e.xp6(2),e.hij("Groups ",a.policySummary?"("+a.policySummary.groups+")":"",""),e.xp6(2),e.Q6J("ngbNavItem",3),e.xp6(2),e.hij("Tags ",a.policySummary?"("+a.policySummary.tags+")":"",""),e.xp6(2),e.Q6J("ngbNavOutlet",i),e.xp6(1),e.Q6J("show",a.loadingData)}},directives:[p.yS,g.Pz,g.nv,g.Vx,g.uN,T.e,c.sXh,c.ilc,c.mKI,c.XXE,c.qvW,v.p6,c.Ak0,c.Auv,p.rH,m.O5,c.Lz9,g.tO,Z.RJ],styles:[""]}),o})();function Tt(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e._UZ(2,"i",25),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.column.caption,"\xa0")}}const q=function(o){return[o]};function vt(o,n){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"a",26),e._uU(2),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,q,"/console/idap/users/details/"+t.data.userName)),e.xp6(1),e.Oqu(t.data.userName)}}function wt(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(3);e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.createDate)," ")}}const D=function(){return{groupPaging:!1}},N=function(){return[10,20,30,40,50]};function At(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"dx-data-grid",13),e.NdJ("selectedRowKeysChange",function(i){return e.CHM(t),e.oxw(2).selectedRows=i}),e._UZ(1,"dxo-paging",14),e._UZ(2,"dxo-pager",15),e._UZ(3,"dxo-load-panel",16),e._UZ(4,"dxo-search-panel",17),e._UZ(5,"dxo-selection",18),e._UZ(6,"dxi-column",19),e._UZ(7,"dxi-column",20),e._UZ(8,"dxi-column",21),e.YNc(9,Tt,3,1,"div",22),e.YNc(10,vt,3,4,"div",22),e.YNc(11,wt,2,1,"div",22),e._UZ(12,"dxo-export",23),e._UZ(13,"dxo-column-chooser",24),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("dataSource",t.usersNotInGroup)("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0)("selectedRowKeys",t.selectedRows),e.xp6(1),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(28,D)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(29,N))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(2),e.Q6J("visible",!1),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("dxTemplateOf","userHeaderTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","userTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","createDateTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}function yt(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e._UZ(2,"i",25),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.column.caption,"\xa0")}}function bt(o,n){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"a",26),e._uU(2),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,q,"/console/idap/policies/details/"+t.data.policyId)),e.xp6(1),e.Oqu(t.data.policyName)}}function Ut(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(3);e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.createDate)," ")}}function Ct(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"dx-data-grid",13),e.NdJ("selectedRowKeysChange",function(i){return e.CHM(t),e.oxw(2).selectedRows=i}),e._UZ(1,"dxo-paging",14),e._UZ(2,"dxo-pager",15),e._UZ(3,"dxo-load-panel",16),e._UZ(4,"dxo-search-panel",17),e._UZ(5,"dxo-selection",18),e._UZ(6,"dxi-column",27),e._UZ(7,"dxi-column",28),e._UZ(8,"dxi-column",21),e.YNc(9,yt,3,1,"div",22),e.YNc(10,bt,3,4,"div",22),e.YNc(11,Ut,2,1,"div",22),e._UZ(12,"dxo-export",23),e._UZ(13,"dxo-column-chooser",24),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("dataSource",t.policiesNotInGroup)("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0)("selectedRowKeys",t.selectedRows),e.xp6(1),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(28,D)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(29,N))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(2),e.Q6J("visible",!1),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("dxTemplateOf","policyHeaderTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","policyTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","createDateTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}function qt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).addUsers()}),e._uU(1," Add users "),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",0==t.selectedRows.length)}}function Dt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).addPolicies()}),e._uU(1," Add policies "),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",0==t.selectedRows.length)}}const O=function(){return["/console/idap/dashboard"]},Nt=function(){return["/console/idap/user-groups"]},F=function(o){return["/console/idap/user-groups/details",o]},Jt=function(o){return{tab:o}};function St(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",3),e.TgZ(2,"div"),e.TgZ(3,"a",4),e._uU(4,"IDAP"),e.qZA(),e._uU(5," \xa0 "),e._UZ(6,"i",5),e._uU(7," \xa0 "),e.TgZ(8,"a",4),e._uU(9,"User groups"),e.qZA(),e._uU(10," \xa0 "),e._UZ(11,"i",5),e._uU(12," \xa0 "),e.TgZ(13,"a",4),e._uU(14),e.qZA(),e._uU(15," \xa0 "),e._UZ(16,"i",5),e._uU(17),e.qZA(),e.TgZ(18,"h3",6),e._uU(19),e.qZA(),e.YNc(20,At,14,30,"dx-data-grid",7),e.YNc(21,Ct,14,30,"dx-data-grid",7),e._UZ(22,"hr",8),e.TgZ(23,"div",9),e.TgZ(24,"div",10),e.TgZ(25,"a",11),e._uU(26,"Cancel"),e.qZA(),e.YNc(27,qt,2,1,"button",12),e.YNc(28,Dt,2,1,"button",12),e.qZA(),e.qZA(),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("routerLink",e.DdM(13,O)),e.xp6(5),e.Q6J("routerLink",e.DdM(14,Nt)),e.xp6(5),e.Q6J("routerLink",e.VKq(15,F,t.groupName)),e.xp6(1),e.Oqu(t.groupName),e.xp6(3),e.hij(" \xa0 ","users"==t.addType?"Add users":"policies"==t.addType?"Attach policies":""," "),e.xp6(2),e.AsE("","users"==t.addType?"Add users":"policies"==t.addType?"Attach policies":""," to ",t.groupName," "),e.xp6(1),e.Q6J("ngIf","users"==t.addType),e.xp6(1),e.Q6J("ngIf","policies"==t.addType),e.xp6(4),e.Q6J("routerLink",e.VKq(17,F,t.groupName))("queryParams",e.VKq(19,Jt,"policies"==t.addType?2:1)),e.xp6(2),e.Q6J("ngIf","users"==t.addType),e.xp6(1),e.Q6J("ngIf","policies"==t.addType)}}function Qt(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e._UZ(2,"i",25),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.column.caption,"\xa0")}}function It(o,n){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"a",26),e._uU(2),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,q,"/console/idap/users/details/"+t.data.groupName)),e.xp6(1),e.Oqu(t.data.groupName)}}function Pt(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(2);e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.createDate)," ")}}const kt=function(){return["/console/idap/policies"]},L=function(o){return["/console/idap/policies/details",o]};function Mt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",3),e.TgZ(1,"div"),e.TgZ(2,"a",4),e._uU(3,"IDAP"),e.qZA(),e._uU(4," \xa0 "),e._UZ(5,"i",5),e._uU(6," \xa0 "),e.TgZ(7,"a",4),e._uU(8,"Policies"),e.qZA(),e._uU(9," \xa0 "),e._UZ(10,"i",5),e._uU(11," \xa0 "),e.TgZ(12,"a",4),e._uU(13),e.qZA(),e._uU(14," \xa0 "),e._UZ(15,"i",5),e._uU(16," \xa0 Add groups "),e.qZA(),e.TgZ(17,"h3",6),e._uU(18),e.qZA(),e.TgZ(19,"dx-data-grid",13),e.NdJ("selectedRowKeysChange",function(i){return e.CHM(t),e.oxw().selectedRows=i}),e._UZ(20,"dxo-paging",14),e._UZ(21,"dxo-pager",15),e._UZ(22,"dxo-load-panel",16),e._UZ(23,"dxo-search-panel",17),e._UZ(24,"dxo-selection",18),e._UZ(25,"dxi-column",30),e._UZ(26,"dxi-column",31),e._UZ(27,"dxi-column",21),e.YNc(28,Qt,3,1,"div",22),e.YNc(29,It,3,4,"div",22),e.YNc(30,Pt,2,1,"div",22),e._UZ(31,"dxo-export",32),e._UZ(32,"dxo-column-chooser",24),e.qZA(),e._UZ(33,"hr",8),e.TgZ(34,"div",9),e.TgZ(35,"div",10),e.TgZ(36,"a",4),e._uU(37,"Cancel"),e.qZA(),e.TgZ(38,"button",29),e.NdJ("click",function(){return e.CHM(t),e.oxw().addPolicies()}),e._uU(39," Add groups "),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("routerLink",e.DdM(35,O)),e.xp6(5),e.Q6J("routerLink",e.DdM(36,kt)),e.xp6(5),e.Q6J("routerLink",e.VKq(37,L,t.policyId)),e.xp6(1),e.Oqu(null==t.policyData?null:t.policyData.policyName),e.xp6(5),e.hij("Add groups to ",null==t.policyData?null:t.policyData.policyName," "),e.xp6(1),e.Q6J("dataSource",t.policiesNotInGroup)("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0)("selectedRowKeys",t.selectedRows),e.xp6(1),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(39,D)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(40,N))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(2),e.Q6J("visible",!1),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("dxTemplateOf","groupHeaderTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","groupTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","createDateTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0),e.xp6(4),e.Q6J("routerLink",e.VKq(41,L,t.policyId)),e.xp6(2),e.Q6J("disabled",0==t.selectedRows.length)}}let E=(()=>{class o{constructor(t,a,i,r){this.core=t,this.route=a,this.idapService=i,this.router=r,this.groupName="",this.policyId="",this.addType="",this.groupUsers=[],this.usersNotInGroup=[],this.users=[],this.groupPolicies=[],this.policiesNotInGroup=[],this.policies=[],this.policyGroups=[],this.groupsNotInPolicy=[],this.groups=[],this.policyData=void 0,this.selectedRows=[],this.loadingData=!1}ngOnInit(){this.groupName=this.route.snapshot.paramMap.get("groupName"),this.policyId=this.route.snapshot.paramMap.get("policyId"),this.addType=this.route.snapshot.paramMap.get("addType"),"users"==this.addType?this.getUsersNotInGroup(this.groupName):"policies"==this.addType?this.getPoliciesNotInGroup(this.groupName):"groups"==this.addType&&this.getGroupsNotInPolicy(this.policyId)}getUsersNotInGroup(t){var a=this;return(0,_.Z)(function*(){try{a.loadingData=!0;let i=yield a.idapService.getUsers();a.users=i.data.users;let r=yield a.idapService.getGroup(t);a.groupUsers=r.data.users,0!=a.users.length&&(a.usersNotInGroup=a.users.filter(l=>null==a.groupUsers.find(d=>d.userId===l.userId))),a.loadingData=!1}catch(i){a.loadingData=!1}})()}getPoliciesNotInGroup(t){var a=this;return(0,_.Z)(function*(){try{a.loadingData=!0;let i=yield a.idapService.getPolicies();a.policies=i.data.policies;let r=yield a.idapService.getGroupPolicies(t);a.groupPolicies=r.data.attachedPolicies,0!=a.policies.length&&(a.policiesNotInGroup=a.policies.filter(l=>null==a.groupPolicies.find(d=>d.policyId===l.policyId))),a.loadingData=!1}catch(i){a.loadingData=!1}})()}getGroupsNotInPolicy(t){var a=this;return(0,_.Z)(function*(){try{a.loadingData=!0;let i=yield a.idapService.getGroups();a.groups=i.data.groups;let r=yield a.idapService.getPolicy(t);a.policyGroups=r.data.groups,a.policyData=r.data.policy,0!=a.groups.length&&(a.policiesNotInGroup=a.groups.filter(l=>null==a.policyGroups.find(d=>d.groupId===l.groupId))),a.loadingData=!1}catch(i){a.loadingData=!1}})()}addUsers(){var t=this;this.loadingData=!0;let a=[],i=[];this.selectedRows.forEach(function(){var r=(0,_.Z)(function*(l){try{yield t.idapService.addGroupUser(t.groupName,l.userName),a.push([l.userName]),t.selectedRows.length==a.length&&(t.core.successToast("User(s) successfully added"),t.loadingData=!1,t.router.navigate(["/console/idap/user-groups/details",t.groupName],{queryParams:{tab:1}}))}catch(d){i.push([l.userName]),t.core.errorToast("Error adding user: "+l.userName),t.loadingData=!1}});return function(l){return r.apply(this,arguments)}}())}addPolicies(){var t=this;this.loadingData=!0;let a=[],i=[];"policies"==this.addType?this.selectedRows.forEach(function(){var r=(0,_.Z)(function*(l){try{yield t.idapService.attachPolicies(l.policyId,t.groupName),a.push([l.policyId]),t.selectedRows.length==a.length&&(t.core.successToast("Policies successfully added"),t.loadingData=!1,t.router.navigate(["/console/idap/user-groups/details",t.groupName],{queryParams:{tab:2}}))}catch(d){i.push([l.policyId]),t.core.errorToast("Error adding policy: "+l.policyName),t.loadingData=!1}});return function(l){return r.apply(this,arguments)}}()):"groups"==this.addType&&this.selectedRows.forEach(function(){var r=(0,_.Z)(function*(l){try{yield t.idapService.attachPolicies(t.policyId,l.groupName),a.push([l.groupName]),t.selectedRows.length==a.length&&(t.core.successToast("Groups successfully attached"),t.loadingData=!1,t.router.navigate(["/console/idap/policies/details",t.policyId]))}catch(d){i.push([l.groupName]),t.core.errorToast("Error attaching group: "+l.groupName),t.loadingData=!1}});return function(l){return r.apply(this,arguments)}}())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.p),e.Y36(p.gz),e.Y36(f.t),e.Y36(p.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-to-group"]],decls:4,vars:3,consts:[[4,"ngIf","ngIfElse"],["elseTemplate",""],[3,"show"],[1,"container-fluid"],[3,"routerLink"],[1,"fa","fa-chevron-right"],[1,"pt-3"],["noDataText","No data available",3,"dataSource","columnAutoWidth","showBorders","showRowLines","showColumnLines","allowColumnReordering","wordWrapEnabled","selectedRowKeys","selectedRowKeysChange",4,"ngIf"],[1,"mt-4"],[1,"row"],[1,"col","d-flex","justify-content-end","align-items-center"],[3,"routerLink","queryParams"],["class","btn btn-sm btn-custom-secondary ms-3",3,"disabled","click",4,"ngIf"],["noDataText","No data available",3,"dataSource","columnAutoWidth","showBorders","showRowLines","showColumnLines","allowColumnReordering","wordWrapEnabled","selectedRowKeys","selectedRowKeysChange"],[3,"enabled","pageSize","remoteOperations"],[3,"showPageSizeSelector","allowedPageSizes","showInfo"],[3,"height","width","showPane","shading"],["placeholder","Search...",3,"visible","width"],["selectAllMode","allPages","showCheckBoxesMode","always","mode","multiple"],["dataField","userId",3,"visible"],["dataField","userName","caption","Username","headerCellTemplate","userHeaderTemplate","cellTemplate","userTemplate",3,"allowHiding"],["dataField","createDate","caption","Created at","cellTemplate","createDateTemplate"],[4,"dxTemplate","dxTemplateOf"],["fileName","Group users",3,"enabled","allowExportSelectedData"],[3,"enabled"],[1,"fa","fa-sm","fa-external-link-alt"],["target","_blank",3,"routerLink"],["dataField","policyId",3,"visible"],["dataField","policyName","caption","Policy name","headerCellTemplate","policyHeaderTemplate","cellTemplate","policyTemplate",3,"allowHiding"],[1,"btn","btn-sm","btn-custom-secondary","ms-3",3,"disabled","click"],["dataField","groupId",3,"visible"],["dataField","groupName","caption","Group name","headerCellTemplate","groupHeaderTemplate","cellTemplate","groupTemplate",3,"allowHiding"],["fileName","Policy groups",3,"enabled","allowExportSelectedData"]],template:function(t,a){if(1&t&&(e.YNc(0,St,29,21,"ng-container",0),e.YNc(1,Mt,40,43,"ng-template",null,1,e.W1O),e._UZ(3,"ngx-loading",2)),2&t){const i=e.MAs(2);e.Q6J("ngIf",a.core.isEmptyOrNull(a.policyId))("ngIfElse",i),e.xp6(3),e.Q6J("show",a.loadingData)}},directives:[m.O5,p.yS,T.e,c.sXh,c.ilc,c.mKI,c.XXE,c.Lz9,c.qvW,v.p6,c.Ak0,c.Auv,Z.RJ],styles:[""]}),o})();const Gt=function(){return["/console/idap/dashboard"]},Y=function(){return["/console/idap/user-groups"]};let Rt=(()=>{class o{constructor(t,a,i,r){this.core=t,this.idapService=a,this.fb=i,this.router=r,this.loadingData=!1}ngOnInit(){this.initForm()}initForm(){this.groupformGroup=this.fb.group({groupName:["",s.kI.compose([s.kI.required,s.kI.maxLength(256),s.kI.minLength(3)])]})}createGroup(){var t=this;return(0,_.Z)(function*(){try{t.loadingData=!0,yield t.idapService.createGroup(t.groupformGroup.value.groupName),t.loadingData=!1,t.router.navigate(["/console/idap/user-groups"])}catch(a){t.loadingData=!1}})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.p),e.Y36(f.t),e.Y36(s.qu),e.Y36(p.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-group"]],decls:32,vars:9,consts:[[1,"container-fluid"],[3,"routerLink"],[1,"fa","fa-chevron-right"],[1,"row","pt-3","align-items-center"],[1,"col"],[1,"mb-3","mt-3","row",3,"formGroup"],["for","groupName",1,"form-label"],[1,"col","col-sm-5"],["type","text","id","groupName","formControlName","groupName",1,"form-control","form-control-sm"],[1,"form-text"],[1,"row"],[1,"col","d-flex","justify-content-end","align-items-center"],[1,"btn","btn-sm","btn-custom-secondary","ms-3",3,"disabled","click"],[3,"show"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"a",1),e._uU(3,"IDAP"),e.qZA(),e._uU(4," \xa0 "),e._UZ(5,"i",2),e._uU(6," \xa0 "),e.TgZ(7,"a",1),e._uU(8,"User groups"),e.qZA(),e._uU(9," \xa0 "),e._UZ(10,"i",2),e._uU(11," \xa0 Create user group "),e.qZA(),e.TgZ(12,"div",3),e.TgZ(13,"div",4),e.TgZ(14,"h3"),e._uU(15,"Create user group"),e.qZA(),e.qZA(),e.qZA(),e._UZ(16,"hr"),e.TgZ(17,"form",5),e.TgZ(18,"label",6),e._uU(19,"User group name"),e.qZA(),e.TgZ(20,"div",7),e._UZ(21,"input",8),e.TgZ(22,"small",9),e._uU(23," Maximum 128 characters. Use alphanumeric and '+=,.@-_' characters. "),e.qZA(),e.qZA(),e.qZA(),e._UZ(24,"hr"),e.TgZ(25,"div",10),e.TgZ(26,"div",11),e.TgZ(27,"a",1),e._uU(28,"Cancel"),e.qZA(),e.TgZ(29,"button",12),e.NdJ("click",function(){return a.createGroup()}),e._uU(30,"Create group"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(31,"ngx-loading",13)),2&t&&(e.xp6(2),e.Q6J("routerLink",e.DdM(6,Gt)),e.xp6(5),e.Q6J("routerLink",e.DdM(7,Y)),e.xp6(10),e.Q6J("formGroup",a.groupformGroup),e.xp6(10),e.Q6J("routerLink",e.DdM(8,Y)),e.xp6(2),e.Q6J("disabled",a.groupformGroup.invalid),e.xp6(2),e.Q6J("show",a.loadingData))},directives:[p.yS,s._Y,s.JL,s.sg,s.Fj,s.JJ,s.u,Z.RJ],styles:[""]}),o})();function Ot(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e._UZ(2,"i",33),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.column.caption,"\xa0")}}const K=function(o){return[o]};function Ft(o,n){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"a",34),e._uU(2),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,K,"/console/idap/users/details/"+t.data.userName)),e.xp6(1),e.Oqu(t.data.userName)}}function Lt(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(2);e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.createDate)," ")}}const Et=function(o){return["/console/idap/user-groups/details/",o,"add","users"]},j=function(){return{groupPaging:!1}},H=function(){return[10,20,30,40,50]};function Yt(o,n){if(1&o&&(e.TgZ(0,"div",19),e.TgZ(1,"div",20),e.TgZ(2,"div",4),e.TgZ(3,"button",21),e._uU(4," Add users "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(5,"dx-data-grid",22),e._UZ(6,"dxo-paging",23),e._UZ(7,"dxo-pager",24),e._UZ(8,"dxo-load-panel",25),e._UZ(9,"dxo-search-panel",26),e._UZ(10,"dxi-column",27),e._UZ(11,"dxi-column",28),e._UZ(12,"dxi-column",29),e.YNc(13,Ot,3,1,"div",30),e.YNc(14,Ft,3,4,"div",30),e.YNc(15,Lt,2,1,"div",30),e._UZ(16,"dxo-export",31),e._UZ(17,"dxo-column-chooser",32),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("routerLink",e.VKq(28,Et,t.groupName)),e.xp6(2),e.Q6J("dataSource",t.groupUsers)("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0),e.xp6(1),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(30,j)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(31,H))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(1),e.Q6J("visible",!1),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("dxTemplateOf","userHeaderTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","userTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","createDateTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}function Kt(o,n){if(1&o&&(e.TgZ(0,"span",44),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij("",null==t.selectedPoliciesRows?null:t.selectedPoliciesRows.length," selected")}}function jt(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e._UZ(2,"i",33),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.column.caption,"\xa0")}}function Ht(o,n){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"a",34),e._uU(2),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,K,"/console/idap/policies/details/"+t.data.policyId)),e.xp6(1),e.Oqu(t.data.policyName)}}function zt(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(2);e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.createDate)," ")}}const Wt=function(o){return["/console/idap/user-groups/details/",o,"add","policies"]};function Bt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",19),e.TgZ(1,"div",20),e.TgZ(2,"div",4),e.TgZ(3,"button",21),e._uU(4," Attach policies "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(5,"span",35),e.TgZ(6,"button",36),e.NdJ("click",function(){return e.CHM(t),e.oxw().detachPolicies()}),e._uU(7,"Detach"),e.qZA(),e.YNc(8,Kt,2,1,"span",37),e.qZA(),e.TgZ(9,"dx-data-grid",38),e.NdJ("selectedRowKeysChange",function(i){return e.CHM(t),e.oxw().selectedPoliciesRows=i}),e._UZ(10,"dxo-paging",23),e._UZ(11,"dxo-pager",24),e._UZ(12,"dxo-load-panel",25),e._UZ(13,"dxo-search-panel",26),e._UZ(14,"dxo-selection",39),e._UZ(15,"dxi-column",40),e._UZ(16,"dxi-column",41),e._UZ(17,"dxi-column",42),e._UZ(18,"dxi-column",29),e.YNc(19,jt,3,1,"div",30),e.YNc(20,Ht,3,4,"div",30),e.YNc(21,zt,2,1,"div",30),e._UZ(22,"dxo-export",43),e._UZ(23,"dxo-column-chooser",32),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("routerLink",e.VKq(31,Wt,t.groupName)),e.xp6(3),e.Q6J("disabled",0==(null==t.selectedPoliciesRows?null:t.selectedPoliciesRows.length)),e.xp6(2),e.Q6J("ngIf",null==t.selectedPoliciesRows?null:t.selectedPoliciesRows.length),e.xp6(1),e.Q6J("dataSource",t.groupPolicies)("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0)("selectedRowKeys",t.selectedPoliciesRows),e.xp6(1),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(33,j)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(34,H))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(2),e.Q6J("visible",!1),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(3),e.Q6J("dxTemplateOf","policyHeaderTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","policyTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","createDateTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}const Vt=function(){return["/console/idap/dashboard"]},$t=function(){return["/console/idap/user-groups"]};let Xt=(()=>{class o{constructor(t,a,i){this.core=t,this.route=a,this.idapService=i,this.groupName="",this.groupData=void 0,this.groupSummary=void 0,this.groupUsers=[],this.groupPolicies=[],this.selectedPoliciesRows=[],this.loadingData=!1}ngOnInit(){this.groupName=this.route.snapshot.paramMap.get("groupName"),this.route.queryParams.subscribe(t=>{0!=Object.keys(t).length&&(this.active=Number(t.tab),2==this.active&&this.getGroupPolicies(this.groupName))}),this.getGroupDetails(this.groupName)}getGroupDetails(t){this.loadingData=!0,this.idapService.getGroup(t).then(a=>{this.loadingData=!1,this.groupData=a.data.group,this.groupSummary=a.data.summary,this.groupUsers=a.data.users}).catch(a=>{this.loadingData=!1})}getGroupPolicies(t){this.idapService.getGroupPolicies(t).then(a=>{this.groupPolicies=a.data.attachedPolicies})}detachPolicies(){var t=this;if(confirm("Are you sure you want to detach policies")){this.loadingData=!0;let i=[],r=[];this.selectedPoliciesRows.forEach(function(){var l=(0,_.Z)(function*(d){try{yield t.idapService.detachPolicies(d.policyId,t.groupName),i.push([d.policyId]),t.selectedPoliciesRows.length==i.length&&(t.core.successToast("Policies successfully detached"),t.loadingData=!1,t.getGroupPolicies(t.groupName),t.getGroupDetails(t.groupName))}catch(x){r.push([d.policyId]),t.core.errorToast("Error detaching policy: "+d.policyName),t.loadingData=!1}});return function(d){return l.apply(this,arguments)}}())}}onNavChange(t){2===t.nextId&&this.getGroupPolicies(this.groupName)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.p),e.Y36(p.gz),e.Y36(f.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-group-details"]],decls:45,vars:14,consts:[[1,"container-fluid"],[3,"routerLink"],[1,"fa","fa-chevron-right"],[1,"row","pt-3","align-items-center"],[1,"col"],[1,""],[1,"col","d-flex","justify-content-end"],[1,"btn","btn-sm","btn-danger"],[1,"col-12","col-sm-8"],[1,"row"],[1,"col-4","col-sm","d-flex","justify-content-sm-end"],[1,"btn","btn-sm","btn-secondary"],["ngbNav","",1,"nav-pills","pt-3",3,"activeId","activeIdChange","navChange"],["nav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2",3,"ngbNavOutlet"],[3,"show"],[1,"pt-3"],[1,"row","pb-1"],[1,"btn","btn-sm","btn-custom-secondary",3,"routerLink"],["noDataText","No data available",3,"dataSource","columnAutoWidth","showBorders","showRowLines","showColumnLines","allowColumnReordering","wordWrapEnabled"],[3,"enabled","pageSize","remoteOperations"],[3,"showPageSizeSelector","allowedPageSizes","showInfo"],[3,"height","width","showPane","shading"],["placeholder","Search...",3,"visible","width"],["dataField","userId",3,"visible"],["dataField","userName","caption","Username","headerCellTemplate","userHeaderTemplate","cellTemplate","userTemplate",3,"allowHiding"],["dataField","createDate","caption","Created at","cellTemplate","createDateTemplate"],[4,"dxTemplate","dxTemplateOf"],["fileName","Group users",3,"enabled","allowExportSelectedData"],[3,"enabled"],[1,"fa","fa-sm","fa-external-link-alt"],["target","_blank",3,"routerLink"],[1,"add-datagrid-buttons"],[1,"btn","btn-sm","btn-danger",3,"disabled","click"],["class","selection-count text-muted",4,"ngIf"],["noDataText","No data available",3,"dataSource","columnAutoWidth","showBorders","showRowLines","showColumnLines","allowColumnReordering","wordWrapEnabled","selectedRowKeys","selectedRowKeysChange"],["selectAllMode","allPages","showCheckBoxesMode","always","mode","multiple"],["dataField","policyId",3,"visible"],["dataField","policyName","caption","Policy","headerCellTemplate","policyHeaderTemplate","cellTemplate","policyTemplate",3,"allowHiding"],["dataField","description"],["fileName","Group policies",3,"enabled","allowExportSelectedData"],[1,"selection-count","text-muted"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"a",1),e._uU(3,"IDAP"),e.qZA(),e._uU(4," \xa0 "),e._UZ(5,"i",2),e._uU(6," \xa0 "),e.TgZ(7,"a",1),e._uU(8,"User groups"),e.qZA(),e._uU(9," \xa0 "),e._UZ(10,"i",2),e._uU(11),e.qZA(),e.TgZ(12,"div",3),e.TgZ(13,"div",4),e.TgZ(14,"h3",5),e._uU(15),e.qZA(),e.qZA(),e.TgZ(16,"div",6),e.TgZ(17,"button",7),e._uU(18,"Delete"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",3),e.TgZ(20,"div",4),e.TgZ(21,"h5"),e._uU(22,"Summary"),e.qZA(),e.qZA(),e.TgZ(23,"div",8),e.TgZ(24,"div",9),e.TgZ(25,"div",10),e.TgZ(26,"span"),e._uU(27,"Creation time:"),e.qZA(),e.qZA(),e.TgZ(28,"div",4),e._uU(29),e.qZA(),e.qZA(),e.qZA(),e.TgZ(30,"div",6),e.TgZ(31,"button",11),e._uU(32,"Edit"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(33,"nav",12,13),e.NdJ("activeIdChange",function(r){return a.active=r})("navChange",function(r){return a.onNavChange(r)}),e.ynx(35,14),e.TgZ(36,"a",15),e._uU(37),e.qZA(),e.YNc(38,Yt,18,32,"ng-template",16),e.BQk(),e.ynx(39,14),e.TgZ(40,"a",15),e._uU(41),e.qZA(),e.YNc(42,Bt,24,35,"ng-template",16),e.BQk(),e.qZA(),e._UZ(43,"div",17),e.qZA(),e._UZ(44,"ngx-loading",18)),2&t){const i=e.MAs(34);e.xp6(2),e.Q6J("routerLink",e.DdM(12,Vt)),e.xp6(5),e.Q6J("routerLink",e.DdM(13,$t)),e.xp6(4),e.hij(" \xa0 ",a.groupName," "),e.xp6(4),e.Oqu(a.groupName),e.xp6(14),e.hij(" ",a.core.getDate(null==a.groupData?null:a.groupData.createDate)," "),e.xp6(4),e.Q6J("activeId",a.active),e.xp6(2),e.Q6J("ngbNavItem",1),e.xp6(2),e.hij("Users ",a.groupSummary?"("+a.groupSummary.users+")":"",""),e.xp6(2),e.Q6J("ngbNavItem",2),e.xp6(2),e.hij("Policies ",a.groupSummary?"("+a.groupSummary.policies+")":"",""),e.xp6(2),e.Q6J("ngbNavOutlet",i),e.xp6(1),e.Q6J("show",a.loadingData)}},directives:[p.yS,g.Pz,g.nv,g.Vx,g.uN,p.rH,T.e,c.sXh,c.ilc,c.mKI,c.XXE,c.qvW,v.p6,c.Ak0,c.Auv,m.O5,c.Lz9,g.tO,Z.RJ],styles:[""]}),o})();class eo{}function to(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",5),e.TgZ(1,"button",14),e.NdJ("click",function(){return e.CHM(t),e.oxw().getUserGroups()}),e._UZ(2,"i",15),e.qZA(),e.qZA()}}function oo(o,n){if(1&o&&(e.TgZ(0,"span",32),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij("",null==t.selectedRows?null:t.selectedRows.length," selected")}}const ao=function(o){return["../user-groups/details",o]};function no(o,n){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"a",1),e._uU(2),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,ao,t.data.groupName)),e.xp6(1),e.Oqu(t.data.groupName)}}function io(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(2);e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.createDate)," ")}}const ro=function(){return[]},so=function(){return{groupPaging:!1}},lo=function(){return[10,20,30,40,50]};function co(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",16),e.TgZ(2,"button",17),e._uU(3,"Delete"),e.qZA(),e.YNc(4,oo,2,1,"span",18),e.qZA(),e.TgZ(5,"dx-data-grid",19,20),e.NdJ("selectedRowKeysChange",function(i){return e.CHM(t),e.oxw().selectedRows=i}),e._UZ(7,"dxo-paging",21),e._UZ(8,"dxo-pager",22),e._UZ(9,"dxo-load-panel",23),e._UZ(10,"dxo-search-panel",24),e._UZ(11,"dxo-selection",25),e._UZ(12,"dxi-column",26),e._UZ(13,"dxi-column",27),e._UZ(14,"dxi-column",28),e.YNc(15,no,3,4,"div",29),e.YNc(16,io,2,1,"div",29),e._UZ(17,"dxo-export",30),e._UZ(18,"dxo-column-chooser",31),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("disabled",0==(null==t.selectedRows?null:t.selectedRows.length)),e.xp6(2),e.Q6J("ngIf",null==t.selectedRows?null:t.selectedRows.length),e.xp6(1),e.Q6J("dataSource",(null==t.userGroups||null==t.userGroups.data?null:t.userGroups.data.groups)||e.DdM(29,ro))("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0)("selectedRowKeys",t.selectedRows),e.xp6(2),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(30,so)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(31,lo))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(2),e.Q6J("visible",!1),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("dxTemplateOf","groupNameTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","createDateTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}function uo(o,n){if(1&o&&(e.TgZ(0,"div",33),e.TgZ(1,"h4",34),e._uU(2,"Unauthorised action"),e.qZA(),e.TgZ(3,"p"),e._uU(4),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(4),e.Oqu(t.unauthorisedDashboard.description)}}const po=function(){return["../dashboard"]},go=function(){return["../user-groups/create"]};let mo=(()=>{class o{constructor(t,a){this.core=t,this.idapService=a,this.loadingData=!1,this.userGroups=new eo,this.unauthorisedDashboard={authorised:!0,description:""},this.selectedRows=[]}ngOnInit(){this.getUserGroups()}getUserGroups(){this.loadingData=!0,this.idapService.getGroups().then(t=>{this.loadingData=!1,this.unauthorisedDashboard.authorised=!0,this.userGroups=t,console.log("User groups: ",this.userGroups)}).catch(t=>{this.loadingData=!1,this.unauthorisedDashboard=this.core.getUnauthorisedErrorMessage(t)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.p),e.Y36(f.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-user-groups"]],decls:25,vars:9,consts:[[1,"container-fluid"],[3,"routerLink"],[1,"fa","fa-chevron-right"],[1,"row"],[1,"col"],[1,"col","d-flex","justify-content-end"],[1,"text-muted"],[1,"pt-3"],[1,"row","pb-2"],[1,"btn","btn-sm","btn-custom-secondary",3,"routerLink"],["class","col d-flex justify-content-end",4,"ngIf"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[3,"show"],["title","Refresh",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fas","fa-sync-alt"],[1,"add-datagrid-buttons"],[1,"btn","btn-sm","btn-danger",3,"disabled"],["class","selection-count text-muted",4,"ngIf"],["noDataText","No data available",3,"dataSource","columnAutoWidth","showBorders","showRowLines","showColumnLines","allowColumnReordering","wordWrapEnabled","selectedRowKeys","selectedRowKeysChange"],["userGroupsContainer",""],[3,"enabled","pageSize","remoteOperations"],[3,"showPageSizeSelector","allowedPageSizes","showInfo"],[3,"height","width","showPane","shading"],["placeholder","Search...",3,"visible","width"],["selectAllMode","allPages","showCheckBoxesMode","always","mode","multiple"],["dataField","groupId",3,"visible"],["dataField","groupName","caption","Group name","cellTemplate","groupNameTemplate",3,"allowHiding"],["dataField","createDate","caption","Created at","cellTemplate","createDateTemplate"],[4,"dxTemplate","dxTemplateOf"],["fileName","User groups",3,"enabled","allowExportSelectedData"],[3,"enabled"],[1,"selection-count","text-muted"],[1,"alert","alert-danger"],[1,"alert-heading"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"a",1),e._uU(3,"IDAP"),e.qZA(),e._uU(4," \xa0 "),e._UZ(5,"i",2),e._uU(6," \xa0 User groups "),e.qZA(),e._UZ(7,"hr"),e.TgZ(8,"div",3),e.TgZ(9,"div",4),e.TgZ(10,"h4"),e._uU(11,"User groups"),e.qZA(),e.qZA(),e.TgZ(12,"div",5),e.TgZ(13,"span",6),e._uU(14),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"div",7),e.TgZ(16,"div",8),e.TgZ(17,"div",4),e.TgZ(18,"button",9),e._uU(19,"Create group"),e.qZA(),e.qZA(),e.YNc(20,to,3,0,"div",10),e.qZA(),e.YNc(21,co,19,32,"ng-container",11),e.YNc(22,uo,5,1,"ng-template",null,12,e.W1O),e.qZA(),e.qZA(),e._UZ(24,"ngx-loading",13)),2&t){const i=e.MAs(23);e.xp6(2),e.Q6J("routerLink",e.DdM(7,po)),e.xp6(12),e.hij("Total: ",(null==a.userGroups||null==a.userGroups.data||null==a.userGroups.data.groups?null:a.userGroups.data.groups.length)||0,""),e.xp6(4),e.Q6J("routerLink",e.DdM(8,go)),e.xp6(2),e.Q6J("ngIf",a.unauthorisedDashboard.authorised),e.xp6(1),e.Q6J("ngIf",a.unauthorisedDashboard.authorised)("ngIfElse",i),e.xp6(3),e.Q6J("show",a.loadingData)}},directives:[p.yS,p.rH,m.O5,T.e,c.sXh,c.ilc,c.mKI,c.XXE,c.Lz9,c.qvW,v.p6,c.Ak0,c.Auv,Z.RJ],styles:[""]}),o})();var z=u(2340);let _o=(()=>{class o{constructor(t){this.core=t,this.fullBaseUrl=`${z.N.baseUrl}/${z.N.apiPath}`}getProvinces(){return this.core.makeRemoteRequest(`${this.fullBaseUrl}/listProvinces`,"post",{})}getProvince(t,a){{let i=`${this.fullBaseUrl}/getProvince`,r={};return this.core.isEmptyOrNull(t)||(r.name=t),this.core.isEmptyOrNull(a)||(r.code=a),this.core.makeRemoteRequest(i,"post",r)}}getDistricts(){return this.core.makeRemoteRequest(`${this.fullBaseUrl}/listDistricts`,"post",{})}getDistrict(t,a){{let i=`${this.fullBaseUrl}/getDistrict`,r={};return this.core.isEmptyOrNull(t)||(r.name=t),this.core.isEmptyOrNull(a)||(r.code=a),this.core.makeRemoteRequest(i,"post",r)}}getLocals(){return this.core.makeRemoteRequest(`${this.fullBaseUrl}/listLocals`,"post",{})}getLocal(t,a){{let i=`${this.fullBaseUrl}/getLocal`,r={};return this.core.isEmptyOrNull(t)||(r.name=t),this.core.isEmptyOrNull(a)||(r.code=a),this.core.makeRemoteRequest(i,"post",r)}}getWards(){return this.core.makeRemoteRequest(`${this.fullBaseUrl}/listWards`,"post",{})}getWard(t,a){{let i=`${this.fullBaseUrl}/getWard`,r={};return this.core.isEmptyOrNull(t)||(r.code=t),r.number=a,this.core.makeRemoteRequest(i,"post",r)}}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(h.p))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const ho=["createGroupModal"],Zo=["stepper"];function fo(o,n){1&o&&e._uU(0,"Details")}function xo(o,n){if(1&o&&(e.TgZ(0,"option",74),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.hij(" ",t.name||t.code," ")}}function To(o,n){if(1&o&&(e.TgZ(0,"option",74),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.hij(" ",t.name||t.code," ")}}function vo(o,n){if(1&o&&(e.TgZ(0,"option",74),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.hij(" ",t.name||t.code," ")}}function wo(o,n){if(1&o&&(e.TgZ(0,"option",74),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("ngValue",t.wardId),e.xp6(1),e.hij(" ",t.name||t.code," ")}}function Ao(o,n){1&o&&(e.TgZ(0,"div"),e._uU(1," Key can contain alphanumeric characters, or any of the following: _.:/=+-@ "),e.qZA())}function yo(o,n){if(1&o&&(e.TgZ(0,"div",84),e.YNc(1,Ao,2,0,"div",85),e.qZA()),2&o){e.oxw();const t=e.MAs(3);e.xp6(1),e.Q6J("ngIf",null==t.errors?null:t.errors.pattern)}}function bo(o,n){1&o&&(e.TgZ(0,"div"),e._uU(1," Value can contain alphanumeric characters, or any of the following: _.:/=+-@ "),e.qZA())}function Uo(o,n){if(1&o&&(e.TgZ(0,"div",84),e.YNc(1,bo,2,0,"div",85),e.qZA()),2&o){e.oxw();const t=e.MAs(7);e.xp6(1),e.Q6J("ngIf",null==t.errors?null:t.errors.pattern)}}function Co(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",86),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw().addTag(i)}),e._UZ(1,"i",87),e._uU(2," Add tag "),e.qZA()}if(2&o){const t=e.oxw().$implicit,a=e.MAs(3),i=e.MAs(7),r=e.oxw();e.Q6J("disabled",!(!r.core.isEmptyOrNull(t.key)&&a.valid)||i.invalid)}}function qo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"i",88),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw().removeTag(i)}),e.qZA()}}const y=function(){return{standalone:!0}},W=function(o){return{validateInput:o}};function Do(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td",24),e.TgZ(2,"input",75,76),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.key=i}),e.qZA(),e.YNc(4,yo,2,1,"div",77),e.qZA(),e.TgZ(5,"td",78),e.TgZ(6,"input",79,80),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.value=i}),e.qZA(),e.YNc(8,Uo,2,1,"div",77),e.qZA(),e.TgZ(9,"td",81),e.YNc(10,Co,3,1,"button",82),e.YNc(11,qo,1,0,"i",83),e.qZA(),e.qZA()}if(2&o){const t=n.$implicit,a=n.index,i=e.MAs(3),r=e.MAs(7),l=e.oxw();e.xp6(2),e.Q6J("ngModel",t.key)("ngModelOptions",e.DdM(14,y))("pattern",l.core.tagPatten)("disabled",t.disabled)("ngClass",e.VKq(15,W,i.dirty&&i.invalid)),e.xp6(2),e.Q6J("ngIf",i.invalid),e.xp6(2),e.Q6J("ngModel",t.value)("ngModelOptions",e.DdM(17,y))("pattern",l.core.tagPatten)("disabled",t.disabled)("ngClass",e.VKq(18,W,r.dirty&&r.invalid)),e.xp6(2),e.Q6J("ngIf",r.invalid),e.xp6(2),e.Q6J("ngIf",l.tags.length-1===a),e.xp6(1),e.Q6J("ngIf",l.tags.length-1!==a)}}function No(o,n){1&o&&e._uU(0,"Profile")}function Jo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",32),e.TgZ(1,"input",89),e.NdJ("click",function(){return e.CHM(t),e.oxw().showHidePassword("customPassword")}),e.qZA(),e.TgZ(2,"label",90),e._uU(3," Show password "),e.qZA(),e.qZA()}}function So(o,n){1&o&&e._uU(0,"Groups")}function Qo(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e._UZ(2,"i",91),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.column.caption,"\xa0")}}const Io=function(o){return["/console/idap/user-groups/details",o]};function Po(o,n){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"a",92),e._uU(2),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,Io,t.data.groupName)),e.xp6(1),e.Oqu(t.data.groupName)}}function ko(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw();e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.createDate)," ")}}function Mo(o,n){1&o&&e._uU(0,"Complete")}const B=function(){return["/console/idap/users"]};function Go(o,n){1&o&&(e.TgZ(0,"a",1),e._uU(1,"Close"),e.qZA()),2&o&&e.Q6J("routerLink",e.DdM(1,B))}function Ro(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",93),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(18);return i.nextStep(r)}),e._uU(1," Next: Profile "),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.userFormGroup.invalid)}}function Oo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",93),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(18);return i.nextStep(r)}),e._uU(1," Next: Groups "),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.userProfileFormGroup.invalid)}}function Fo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",94),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(18);return i.nextStep(r)}),e._uU(1," Next: Credentials "),e.qZA()}}function Lo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",94),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(18);return i.nextStep(r)}),e._uU(1," New user "),e.qZA()}}function Eo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",95),e.TgZ(1,"span",96),e._uU(2),e.qZA(),e.TgZ(3,"button",97),e.NdJ("click",function(){return e.CHM(t).dismiss("Cross click")}),e.qZA(),e.qZA(),e.TgZ(4,"div",98),e.TgZ(5,"form",99),e.TgZ(6,"label",14),e._uU(7,"User group name"),e.qZA(),e.TgZ(8,"div",4),e._UZ(9,"input",100),e.TgZ(10,"small",17),e._uU(11," Maximum 128 characters. Use alphanumeric and '+=,.@-_' characters. "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",101),e.TgZ(13,"div",13),e.TgZ(14,"div",68),e.TgZ(15,"span",102),e.NdJ("click",function(){return e.CHM(t).dismiss("Cancel")}),e._uU(16,"Cancel"),e.qZA(),e.TgZ(17,"button",93),e.NdJ("click",function(){return e.CHM(t),e.oxw().createGroup()}),e._uU(18,"Create group"),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(2),e.Oqu(t.modalTitle),e.xp6(3),e.Q6J("formGroup",t.groupFormGroup),e.xp6(12),e.Q6J("disabled",t.groupFormGroup.invalid)}}const Yo=function(){return["/console/idap/dashboard"]},Ko=function(){return{groupPaging:!1}},jo=function(){return[10,20,30,40,50]};let Ho=(()=>{class o{constructor(t,a,i,r,l){this.core=t,this.idapService=a,this.fb=i,this.generalService=r,this.loadingData=!1,this.modalTitle="",this.groups=[],this.provinces=[],this.districts=[],this.locals=[],this.wards=[],this.selectedRows=[],this.isLinear=!0,this.provinceTag={key:"province",value:""},this.districtTag={key:"district",value:""},this.localTag={key:"local",value:""},this.wardTag={key:"ward",value:""},this.defaultTags=[],this.tags=[{key:"",value:"",disabled:!1}],this.tempLocalStorageKeys=["user-group-data","user-profile-data","new-user-detail"],this.stepperOrientation=l.observe("(min-width: 600px)").pipe((0,b.U)(({matches:d})=>d?"horizontal":"vertical"))}ngOnInit(){this.initUserForm(),this.loadUserForm(),this.initUserProfileForm(),this.passwordTypeChange(),this.initGroupForm(),this.loadGeoData()}ngAfterViewInit(){let t;this.core.isEmptyOrNull(localStorage.getItem(this.tempLocalStorageKeys[0]))?this.core.isEmptyOrNull(localStorage.getItem(this.tempLocalStorageKeys[1]))?this.core.isEmptyOrNull(localStorage.getItem(this.tempLocalStorageKeys[2]))||(t=JSON.parse(localStorage.getItem(this.tempLocalStorageKeys[2])),this.stepper.selectedIndex=null!=t||null!=t?t.completedStep+1:0):(t=JSON.parse(localStorage.getItem(this.tempLocalStorageKeys[1])),this.stepper.selectedIndex=null!=t||null!=t?t.completedStep:0,this.stepper.selectedIndex=null!=t||null!=t?t.completedStep+1:0,this.getGroups()):(t=JSON.parse(localStorage.getItem(this.tempLocalStorageKeys[0])),this.stepper.selectedIndex=null!=t||null!=t?t.completedStep-1:0,this.stepper.selectedIndex=null!=t||null!=t?t.completedStep:0,this.stepper.selectedIndex=null!=t||null!=t?t.completedStep+1:0)}initUserForm(){this.userFormGroup=this.fb.group({userName:["",s.kI.compose([s.kI.required,s.kI.maxLength(256),s.kI.minLength(3)])],tags:[],defaultTags:[],newUser:[]})}loadUserForm(){if(!this.core.isEmptyOrNull(localStorage.getItem(this.tempLocalStorageKeys[2]))){let t=JSON.parse(localStorage.getItem(this.tempLocalStorageKeys[2]));this.userFormGroup.patchValue({userName:t.userName})}}initUserProfileForm(){this.userProfileFormGroup=this.fb.group({passwordType:["auto",s.kI.required],password:[""],requirePasswordReset:[!0]}),this.userProfileFormGroup.controls.password.disable()}passwordTypeChange(){this.userProfileFormGroup.controls.passwordType.valueChanges.subscribe(t=>{"custom"==t?(this.userProfileFormGroup.controls.password.enable(),this.userProfileFormGroup.controls.password.setValidators(s.kI.compose([s.kI.required,s.kI.maxLength(256),s.kI.minLength(3)])),this.userProfileFormGroup.controls.password.updateValueAndValidity()):this.userProfileFormGroup.controls.password.disable()})}initGroupForm(){this.groupFormGroup=this.fb.group({groupName:["",s.kI.compose([s.kI.required,s.kI.maxLength(256),s.kI.minLength(3)])]})}loadGeoData(){this.getProvinces()}addTag(t){this.tags[t].disabled=!0,this.tags.push({key:"",value:"",disabled:!1})}addDefaultTag(t,a){let i=this.defaultTags.findIndex(r=>r.key==t);-1!=i?this.core.isEmptyOrNull(a.value)?this.defaultTags.splice(i,1):this.defaultTags.splice(i,1,a):this.defaultTags.push(a)}removeTag(t){this.tags.splice(t,1)}onGeoChange(t){"province"===t?(this.addDefaultTag(t,{key:this.provinceTag.key,value:this.provinceTag.value.provinceId}),this.getProvince(this.provinceTag.value.name,this.provinceTag.value.code)):"district"===t?(this.addDefaultTag(t,{key:this.districtTag.key,value:this.districtTag.value.districtMunicipalityId}),this.locals=this.districtTag.value.locals):"local"===t?(this.addDefaultTag(t,{key:this.localTag.key,value:this.localTag.value.localMunicipalityId}),this.getlocal(this.localTag.value.name,this.localTag.value.code)):"ward"===t&&this.addDefaultTag(t,this.wardTag)}get password(){let t=JSON.parse(localStorage.getItem(this.tempLocalStorageKeys[1]));return null==t?void 0:t.password}createUserDetail(t){var a=this;return(0,_.Z)(function*(){try{a.loadingData=!0;let i=a.core._lodashRef.cloneDeep(a.tags);i.splice(i.length-1,1),i.map(l=>{a.core.sanitiseRequestObject(l,"","disabled")}),a.userFormGroup.controls.tags.setValue([...a.defaultTags,...i]),console.log(a.userFormGroup.getRawValue());let r=yield a.idapService.createUser(a.userFormGroup.value.userName,a.userFormGroup.value.tags);a.loadingData=!1,a.userFormGroup.controls.newUser.setValue(r),localStorage.setItem(a.tempLocalStorageKeys[2],JSON.stringify(Object.assign(Object.assign({},a.userFormGroup.value),{completedStep:t.selectedIndex}))),t.next(),console.log("New user: ",r,a.userFormGroup.value)}catch(i){a.loadingData=!1}})()}createLoginProfile(t){var a=this;return(0,_.Z)(function*(){try{a.loadingData=!0,"auto"===a.userProfileFormGroup.value.passwordType&&a.userProfileFormGroup.controls.password.setValue(a.core.generatePassword()),yield a.idapService.createLoginProfile(a.userFormGroup.value.userName,a.userProfileFormGroup.getRawValue().password,a.userProfileFormGroup.value.requirePasswordReset),a.loadingData=!1,localStorage.setItem(a.tempLocalStorageKeys[1],JSON.stringify(Object.assign(Object.assign({},a.userProfileFormGroup.getRawValue()),{completedStep:t.selectedIndex}))),t.next(),a.getGroups()}catch(i){a.loadingData=!1}})()}addUserToGroup(t){var a=this;this.loadingData=!0;let i=[],r=[];this.selectedRows.forEach(function(){var l=(0,_.Z)(function*(d,x){try{yield a.idapService.addGroupUser(d.groupName,a.userFormGroup.value.userName),i.push([d.groupName,x]),a.selectedRows.length==i.length&&(localStorage.setItem(a.tempLocalStorageKeys[0],JSON.stringify({rows:a.selectedRows,completedStep:t.selectedIndex})),t.next())}catch(X){r.push([d.groupName,x])}});return function(d,x){return l.apply(this,arguments)}}()),this.loadingData=!1}getGroups(){this.loadingData=!0,this.idapService.getGroups().then(t=>{this.loadingData=!1,this.groups=t.data.groups}).catch(()=>{this.loadingData=!1})}getProvinces(){this.generalService.getProvinces().then(t=>{this.provinces=t.data})}getProvince(t,a){this.loadingData=!0,this.generalService.getProvince(t,a).then(i=>{this.districts=i.data.districts,this.loadingData=!1}).catch(()=>{this.loadingData=!1})}getlocal(t,a){this.loadingData=!0,this.generalService.getLocal(t,a).then(i=>{this.loadingData=!1}).catch(()=>{this.loadingData=!1})}openCreateGroupModal(t){this.modalTitle=t,this.core.openModal(this.createGroupModal).then(a=>{this.getGroups()}).catch(()=>{})}createGroup(){var t=this;return(0,_.Z)(function*(){try{t.loadingData=!0,yield t.idapService.createGroup(t.groupFormGroup.value.groupName),t.loadingData=!1,t.core.closeModal()}catch(a){t.loadingData=!1}})()}nextStep(t){console.log("Current step index: ",t.selectedIndex),0==t.selectedIndex?this.createUserDetail(t):1==t.selectedIndex?this.createLoginProfile(t):2==t.selectedIndex?this.addUserToGroup(t):(this.userFormGroup.reset(),this.userProfileFormGroup.reset(),t.reset(),this.tempLocalStorageKeys.forEach(a=>{localStorage.removeItem(a)}))}showHidePassword(t){let a=document.getElementById(t);a.type="password"===a.type?"text":"password"}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.p),e.Y36(f.t),e.Y36(s.qu),e.Y36(_o),e.Y36(I))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-user"]],viewQuery:function(t,a){if(1&t&&(e.Gf(ho,5),e.Gf(Zo,5)),2&t){let i;e.iGM(i=e.CRH())&&(a.createGroupModal=i.first),e.iGM(i=e.CRH())&&(a.stepper=i.first)}},decls:189,vars:72,consts:[[1,"container-fluid"],[3,"routerLink"],[1,"fa","fa-chevron-right"],[1,"row","pt-3","align-items-center"],[1,"col"],[1,"row","mat-typography"],["labelPosition","bottom",3,"linear","orientation"],["stepper",""],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],[1,"mb-1","mt-3","fw-bold"],[1,"mt-1"],[1,"row"],["for","groupName",1,"form-label"],[1,"col","col-sm-5"],["type","text","id","groupName","formControlName","userName",1,"form-control","form-control-sm"],[1,"form-text"],[1,"mt-1","mb-1"],[1,"col","table-responsive","pb-2"],[1,"table","mb-1"],[1,"table-light"],["scope","col"],["scope","col",1,"text-center"],["width","20%"],["type","text","disabled","",1,"form-control","form-control-sm",3,"value"],[1,"form-select","form-select-sm",3,"ngModel","ngModelOptions","ngModelChange","change"],["value",""],[3,"ngValue",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"form-label","col","col-sm-3","d-flex","justify-content-sm-end","fw-bold"],[1,"col","col-sm-8"],[1,"form-check"],["type","radio","id","autogenerated","value","auto","formControlName","passwordType",1,"form-check-input"],["for","autogenerated",1,"form-check-label"],["type","radio","id","custom","value","custom","formControlName","passwordType",1,"form-check-input"],["for","custom",1,"form-check-label"],[1,"row","ps-3","pt-2"],[1,"col","col-sm-5","ps-3"],["type","password","id","customPassword","formControlName","password",1,"form-control","form-control-sm"],["class","form-check",4,"ngIf"],[1,"row","pt-3"],["type","checkbox","id","requireReset","formControlName","requirePasswordReset",1,"form-check-input"],["for","requireReset",1,"form-check-label"],[1,"row","pb-2","pt-2"],[1,"btn","btn-sm","btn-custom-primary",3,"click"],[1,"col","d-flex","justify-content-sm-end"],[1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fas","fa-sync-alt"],["noDataText","No data available",3,"dataSource","columnAutoWidth","showBorders","showRowLines","showColumnLines","allowColumnReordering","wordWrapEnabled","selectedRowKeys","selectedRowKeysChange"],[3,"enabled","pageSize","remoteOperations"],[3,"showPageSizeSelector","allowedPageSizes","showInfo"],[3,"height","width","showPane","shading"],["placeholder","Search...",3,"visible","width"],["selectAllMode","allPages","showCheckBoxesMode","always","mode","multiple"],["dataField","groupId",3,"visible"],["dataField","groupName","caption","Group name","headerCellTemplate","groupHeaderTemplate","cellTemplate","groupNameTemplate",3,"allowHiding"],["dataField","createDate","caption","Created at","cellTemplate","createDateTemplate"],[4,"dxTemplate","dxTemplateOf"],["fileName","User groups",3,"enabled","allowExportSelectedData"],[3,"enabled"],[1,"align-middle"],["title","Send email",1,"text-button"],[1,"fa","fa-paper-plane"],["title","Copy credentials",1,"text-button"],[1,"fa","fa-copy"],[1,"mt-4"],[1,"fw-bold"],[1,"col","d-flex","justify-content-end","align-items-center"],[3,"routerLink",4,"ngIf"],["class","btn btn-sm btn-custom-secondary ms-3",3,"disabled","click",4,"ngIf"],["class","btn btn-sm btn-custom-secondary ms-3",3,"click",4,"ngIf"],["createGroupModal",""],[3,"show"],[3,"ngValue"],["type","text","placeholder","Add new key",1,"form-control","form-control-sm",3,"ngModel","ngModelOptions","pattern","disabled","ngClass","ngModelChange"],["key","ngModel"],["class","invalid-feedback d-block",4,"ngIf"],["width","68%"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelOptions","pattern","disabled","ngClass","ngModelChange"],["value","ngModel"],[1,"text-center","align-middle"],["class","btn btn-sm btn-custom-primary",3,"disabled","click",4,"ngIf"],["class","fas fa-times",3,"click",4,"ngIf"],[1,"invalid-feedback","d-block"],[4,"ngIf"],[1,"btn","btn-sm","btn-custom-primary",3,"disabled","click"],[1,"fas","fa-plus"],[1,"fas","fa-times",3,"click"],["type","checkbox","value","","id","showPassword",1,"form-check-input",3,"click"],["for","showPassword",1,"form-check-label"],[1,"fa","fa-sm","fa-external-link-alt"],["target","_blank",3,"routerLink"],[1,"btn","btn-sm","btn-custom-secondary","ms-3",3,"disabled","click"],[1,"btn","btn-sm","btn-custom-secondary","ms-3",3,"click"],[1,"modal-header","app-bg-custom"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-custom-secondary","btn-close",3,"click"],[1,"modal-body"],[1,"row",3,"formGroup"],["type","text","id","groupName","formControlName","groupName",1,"form-control","form-control-sm"],[1,"modal-footer","app-bg-custom","pt-1","pb-1"],[1,"text-button",3,"click"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"a",1),e._uU(3,"IDAP"),e.qZA(),e._uU(4," \xa0 "),e._UZ(5,"i",2),e._uU(6," \xa0 "),e.TgZ(7,"a",1),e._uU(8,"Users"),e.qZA(),e._uU(9," \xa0 "),e._UZ(10,"i",2),e._uU(11," \xa0 Create user "),e.qZA(),e.TgZ(12,"div",3),e.TgZ(13,"div",4),e.TgZ(14,"h3"),e._uU(15,"Create user"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",5),e.TgZ(17,"mat-stepper",6,7),e.ALo(19,"async"),e.TgZ(20,"mat-step",8),e.TgZ(21,"form",9),e.YNc(22,fo,1,0,"ng-template",10),e.TgZ(23,"h4",11),e._uU(24,"Set user details"),e.qZA(),e._UZ(25,"hr",12),e.TgZ(26,"div",13),e.TgZ(27,"label",14),e._uU(28,"User name"),e.TgZ(29,"span"),e._uU(30,"*"),e.qZA(),e.qZA(),e.TgZ(31,"div",15),e._UZ(32,"input",16),e.TgZ(33,"small",17),e._uU(34," Maximum 128 characters. Use alphanumeric and '+=,.@-_' characters. "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(35,"h4",11),e._uU(36,"Add tags"),e.qZA(),e._UZ(37,"hr",18),e.TgZ(38,"div",13),e.TgZ(39,"p"),e._uU(40,"IDAP tags are key-value pairs you can add to your user. Tags can include user information, such as an email address, or can be descriptive, such as a job title. You can use the tags to organize, track, or control access for this user."),e.qZA(),e.TgZ(41,"div",19),e.TgZ(42,"table",20),e.TgZ(43,"thead",21),e.TgZ(44,"tr"),e.TgZ(45,"th",22),e._uU(46,"Key*"),e.qZA(),e.TgZ(47,"th",22),e._uU(48,"Value"),e.qZA(),e.TgZ(49,"th",23),e._uU(50,"Action"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(51,"tbody"),e.TgZ(52,"tr"),e.TgZ(53,"td",24),e._UZ(54,"input",25),e.qZA(),e.TgZ(55,"td"),e.TgZ(56,"select",26),e.NdJ("ngModelChange",function(r){return a.provinceTag.value=r})("change",function(){return a.onGeoChange("province")}),e.TgZ(57,"option",27),e._uU(58,"Select a province..."),e.qZA(),e.YNc(59,xo,2,2,"option",28),e.qZA(),e.qZA(),e.qZA(),e.TgZ(60,"tr"),e.TgZ(61,"td",24),e._UZ(62,"input",25),e.qZA(),e.TgZ(63,"td"),e.TgZ(64,"select",26),e.NdJ("ngModelChange",function(r){return a.districtTag.value=r})("change",function(){return a.onGeoChange("district")}),e.TgZ(65,"option",27),e._uU(66,"Select a district..."),e.qZA(),e.YNc(67,To,2,2,"option",28),e.qZA(),e.qZA(),e.qZA(),e.TgZ(68,"tr"),e.TgZ(69,"td",24),e._UZ(70,"input",25),e.qZA(),e.TgZ(71,"td"),e.TgZ(72,"select",26),e.NdJ("ngModelChange",function(r){return a.localTag.value=r})("change",function(){return a.onGeoChange("local")}),e.TgZ(73,"option",27),e._uU(74,"Select a local..."),e.qZA(),e.YNc(75,vo,2,2,"option",28),e.qZA(),e.qZA(),e.qZA(),e.TgZ(76,"tr"),e.TgZ(77,"td",24),e._UZ(78,"input",25),e.qZA(),e.TgZ(79,"td"),e.TgZ(80,"select",26),e.NdJ("ngModelChange",function(r){return a.wardTag.value=r})("change",function(){return a.onGeoChange("ward")}),e.TgZ(81,"option",27),e._uU(82,"Select a ward..."),e.qZA(),e.YNc(83,wo,2,2,"option",28),e.qZA(),e.qZA(),e.qZA(),e.YNc(84,Do,12,20,"tr",29),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(85,"mat-step",8),e.TgZ(86,"form",9),e.YNc(87,No,1,0,"ng-template",10),e.TgZ(88,"h4",11),e._uU(89,"Set profile password"),e.qZA(),e._UZ(90,"hr",18),e.TgZ(91,"div",13),e.TgZ(92,"p"),e._uU(93,"Autogenerated passwords are provided in the last step."),e.qZA(),e.TgZ(94,"label",30),e._uU(95," Console password"),e.TgZ(96,"span"),e._uU(97,"*"),e.qZA(),e.qZA(),e.TgZ(98,"div",31),e.TgZ(99,"div",32),e._UZ(100,"input",33),e.TgZ(101,"label",34),e._uU(102," Autogenerated password "),e.qZA(),e.qZA(),e.TgZ(103,"div",32),e._UZ(104,"input",35),e.TgZ(105,"label",36),e._uU(106," Custom password "),e.qZA(),e.qZA(),e.TgZ(107,"div",37),e.TgZ(108,"div",38),e._UZ(109,"input",39),e.YNc(110,Jo,4,0,"div",40),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(111,"div",41),e.TgZ(112,"label",30),e._uU(113," Require password reset"),e.qZA(),e.TgZ(114,"div",31),e.TgZ(115,"div",32),e._UZ(116,"input",42),e.TgZ(117,"label",43),e._uU(118," Users must create a new password at next sign-in "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(119,"mat-step"),e.YNc(120,So,1,0,"ng-template",10),e.TgZ(121,"h4",11),e._uU(122,"Add user to group(s)"),e.qZA(),e._UZ(123,"hr",12),e.TgZ(124,"div",44),e.TgZ(125,"div",4),e.TgZ(126,"button",45),e.NdJ("click",function(){return a.openCreateGroupModal("Create user group")}),e._uU(127,"New group"),e.qZA(),e.qZA(),e.TgZ(128,"div",46),e.TgZ(129,"button",47),e.NdJ("click",function(){return a.getGroups()}),e._UZ(130,"i",48),e.qZA(),e.qZA(),e.qZA(),e.TgZ(131,"dx-data-grid",49),e.NdJ("selectedRowKeysChange",function(r){return a.selectedRows=r}),e._UZ(132,"dxo-paging",50),e._UZ(133,"dxo-pager",51),e._UZ(134,"dxo-load-panel",52),e._UZ(135,"dxo-search-panel",53),e._UZ(136,"dxo-selection",54),e._UZ(137,"dxi-column",55),e._UZ(138,"dxi-column",56),e._UZ(139,"dxi-column",57),e.YNc(140,Qo,3,1,"div",58),e.YNc(141,Po,3,4,"div",58),e.YNc(142,ko,2,1,"div",58),e._UZ(143,"dxo-export",59),e._UZ(144,"dxo-column-chooser",60),e.qZA(),e.qZA(),e.TgZ(145,"mat-step"),e.YNc(146,Mo,1,0,"ng-template",10),e.TgZ(147,"h4",11),e._uU(148,"User credentials"),e.qZA(),e._UZ(149,"hr",18),e.TgZ(150,"div",13),e.TgZ(151,"p"),e._uU(152,"You can either copy the credentials or send an email to the recipient"),e.qZA(),e.TgZ(153,"div",19),e.TgZ(154,"table",20),e.TgZ(155,"thead",21),e.TgZ(156,"tr"),e.TgZ(157,"th",22),e._uU(158,"User name"),e.qZA(),e.TgZ(159,"th",22),e._uU(160,"Password"),e.qZA(),e.TgZ(161,"th",22),e._uU(162,"Action"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(163,"tbody"),e.TgZ(164,"tr"),e.TgZ(165,"td"),e._uU(166),e.qZA(),e.TgZ(167,"td"),e._uU(168),e.qZA(),e.TgZ(169,"td",61),e.TgZ(170,"span",62),e._UZ(171,"i",63),e.qZA(),e._uU(172,"\xa0 "),e.TgZ(173,"span",64),e._UZ(174,"i",65),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(175,"hr",66),e.TgZ(176,"div",13),e.TgZ(177,"div",4),e.TgZ(178,"span",67),e._uU(179,"* Required"),e.qZA(),e.qZA(),e.TgZ(180,"div",68),e.YNc(181,Go,2,2,"a",69),e.YNc(182,Ro,2,1,"button",70),e.YNc(183,Oo,2,1,"button",70),e.YNc(184,Fo,2,0,"button",71),e.YNc(185,Lo,2,0,"button",71),e.qZA(),e.qZA(),e.qZA(),e.YNc(186,Eo,19,3,"ng-template",null,72,e.W1O),e._UZ(188,"ngx-loading",73)),2&t){const i=e.MAs(18);e.xp6(2),e.Q6J("routerLink",e.DdM(64,Yo)),e.xp6(5),e.Q6J("routerLink",e.DdM(65,B)),e.xp6(10),e.Q6J("linear",a.isLinear)("orientation",e.lcZ(19,62,a.stepperOrientation)),e.xp6(3),e.Q6J("stepControl",a.userFormGroup),e.xp6(1),e.Q6J("formGroup",a.userFormGroup),e.xp6(33),e.Q6J("value",a.provinceTag.key),e.xp6(2),e.Q6J("ngModel",a.provinceTag.value)("ngModelOptions",e.DdM(66,y)),e.xp6(3),e.Q6J("ngForOf",a.provinces),e.xp6(3),e.Q6J("value",a.districtTag.key),e.xp6(2),e.Q6J("ngModel",a.districtTag.value)("ngModelOptions",e.DdM(67,y)),e.xp6(3),e.Q6J("ngForOf",a.districts),e.xp6(3),e.Q6J("value",a.localTag.key),e.xp6(2),e.Q6J("ngModel",a.localTag.value)("ngModelOptions",e.DdM(68,y)),e.xp6(3),e.Q6J("ngForOf",a.locals),e.xp6(3),e.Q6J("value",a.wardTag.key),e.xp6(2),e.Q6J("ngModel",a.wardTag.value)("ngModelOptions",e.DdM(69,y)),e.xp6(3),e.Q6J("ngForOf",a.wards),e.xp6(1),e.Q6J("ngForOf",a.tags),e.xp6(1),e.Q6J("stepControl",a.userProfileFormGroup),e.xp6(1),e.Q6J("formGroup",a.userProfileFormGroup),e.xp6(24),e.Q6J("ngIf","custom"==a.userProfileFormGroup.controls.passwordType.value),e.xp6(21),e.Q6J("dataSource",a.groups)("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0)("selectedRowKeys",a.selectedRows),e.xp6(1),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(70,Ko)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(71,jo))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(2),e.Q6J("visible",!1),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("dxTemplateOf","groupHeaderTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","groupNameTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","createDateTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0),e.xp6(22),e.hij(" ",a.userFormGroup.value.userName," "),e.xp6(2),e.hij(" ",a.password||""," "),e.xp6(13),e.Q6J("ngIf",0==i.selectedIndex||3==i.selectedIndex),e.xp6(1),e.Q6J("ngIf",0==i.selectedIndex),e.xp6(1),e.Q6J("ngIf",1==i.selectedIndex),e.xp6(1),e.Q6J("ngIf",2==i.selectedIndex),e.xp6(1),e.Q6J("ngIf",3==i.selectedIndex),e.xp6(3),e.Q6J("show",a.loadingData)}},directives:[p.yS,w.Vq,w.C0,s._Y,s.JL,s.sg,w.VY,s.Fj,s.JJ,s.u,s.EJ,s.On,s.YN,s.Kr,m.sg,s.c5,m.mk,m.O5,s._,s.Wl,T.e,c.sXh,c.ilc,c.mKI,c.XXE,c.Lz9,c.qvW,v.p6,c.Ak0,c.Auv,Z.RJ],pipes:[m.Ov],styles:[".mat-stepper-label-position-bottom[_ngcontent-%COMP%]   .mat-horizontal-stepper-header[_ngcontent-%COMP%]{padding-left:unset!important}"]}),o})();function zo(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e._UZ(2,"i",31),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.column.caption,"\xa0")}}const Wo=function(o){return[o]};function Bo(o,n){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"a",32),e._uU(2),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,Wo,"/console/idap/user-groups/details/"+t.data.groupName)),e.xp6(1),e.Oqu(t.data.groupName)}}function Vo(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(2);e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.createDate)," ")}}const V=function(){return{groupPaging:!1}},$=function(){return[10,20,30,40,50]};function $o(o,n){if(1&o&&(e.TgZ(0,"div",19),e.TgZ(1,"dx-data-grid",20),e._UZ(2,"dxo-paging",21),e._UZ(3,"dxo-pager",22),e._UZ(4,"dxo-load-panel",23),e._UZ(5,"dxo-search-panel",24),e._UZ(6,"dxi-column",25),e._UZ(7,"dxi-column",26),e._UZ(8,"dxi-column",27),e.YNc(9,zo,3,1,"div",28),e.YNc(10,Bo,3,4,"div",28),e.YNc(11,Vo,2,1,"div",28),e._UZ(12,"dxo-export",29),e._UZ(13,"dxo-column-chooser",30),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.userGroups)("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0),e.xp6(1),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(27,V)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(28,$))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(1),e.Q6J("visible",!1),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("dxTemplateOf","groupHeaderTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","groupTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","createDateTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}const Xo=function(){return[]};function ea(o,n){if(1&o&&(e.TgZ(0,"dx-data-grid",20),e._UZ(1,"dxo-paging",21),e._UZ(2,"dxo-pager",22),e._UZ(3,"dxo-load-panel",23),e._UZ(4,"dxo-search-panel",24),e._UZ(5,"dxi-column",33),e._UZ(6,"dxi-column",34),e._UZ(7,"dxo-export",35),e._UZ(8,"dxo-column-chooser",30),e.qZA()),2&o){const t=e.oxw();e.Q6J("dataSource",(null==t.userData||null==t.userData.user?null:t.userData.user.tags)||e.DdM(23,Xo))("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0),e.xp6(1),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(24,V)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(25,$))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}const ta=function(){return["/console/idap/dashboard"]},oa=function(){return["/console/idap/users"]};let aa=(()=>{class o{constructor(t,a,i,r){this.core=t,this.fb=a,this.route=i,this.idapService=r,this.userName="",this.userData=void 0,this.userGroups=[],this.loadingData=!1}ngOnInit(){this.userName=this.route.snapshot.paramMap.get("userName"),this.getUserDetails(this.userName),this.getUserGroups(this.userName)}getUserDetails(t){this.loadingData=!0,this.idapService.getUser(t).then(a=>{this.loadingData=!1,this.userData=a.data}).catch(a=>{this.loadingData=!1})}getUserGroups(t){this.loadingData=!0,this.idapService.getUserGroups(t).then(a=>{this.loadingData=!1,this.userGroups=a.data.groups}).catch(a=>{this.loadingData=!1})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.p),e.Y36(s.qu),e.Y36(p.gz),e.Y36(f.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-user-details"]],decls:45,vars:11,consts:[[1,"container-fluid"],[3,"routerLink"],[1,"fa","fa-chevron-right"],[1,"row","pt-3","align-items-center"],[1,"col"],[1,""],[1,"col","d-flex","justify-content-end"],[1,"btn","btn-sm","btn-danger"],[1,"col-12","col-sm-8"],[1,"row"],[1,"col-4","col-sm","d-flex","justify-content-sm-end"],[1,"btn","btn-sm","btn-secondary"],["ngbNav","",1,"nav-pills","pt-3"],["nav","ngbNav"],["ngbNavItem",""],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2",3,"ngbNavOutlet"],[3,"show"],[1,"pt-3"],["noDataText","No data available",3,"dataSource","columnAutoWidth","showBorders","showRowLines","showColumnLines","allowColumnReordering","wordWrapEnabled"],[3,"enabled","pageSize","remoteOperations"],[3,"showPageSizeSelector","allowedPageSizes","showInfo"],[3,"height","width","showPane","shading"],["placeholder","Search...",3,"visible","width"],["dataField","groupId",3,"visible"],["dataField","groupName","caption","Group name","headerCellTemplate","groupHeaderTemplate","cellTemplate","groupTemplate",3,"allowHiding"],["dataField","createDate","caption","Created at","cellTemplate","createDateTemplate"],[4,"dxTemplate","dxTemplateOf"],["fileName","User groups",3,"enabled","allowExportSelectedData"],[3,"enabled"],[1,"fa","fa-sm","fa-external-link-alt"],["target","_blank",3,"routerLink"],["dataField","key",3,"allowHiding"],["dataField","value"],["fileName","User tags",3,"enabled","allowExportSelectedData"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"a",1),e._uU(3,"IDAP"),e.qZA(),e._uU(4," \xa0 "),e._UZ(5,"i",2),e._uU(6," \xa0 "),e.TgZ(7,"a",1),e._uU(8,"Users"),e.qZA(),e._uU(9," \xa0 "),e._UZ(10,"i",2),e._uU(11),e.qZA(),e.TgZ(12,"div",3),e.TgZ(13,"div",4),e.TgZ(14,"h3",5),e._uU(15),e.qZA(),e.qZA(),e.TgZ(16,"div",6),e.TgZ(17,"button",7),e._uU(18,"Delete"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",3),e.TgZ(20,"div",4),e.TgZ(21,"h5"),e._uU(22,"Summary"),e.qZA(),e.qZA(),e.TgZ(23,"div",8),e.TgZ(24,"div",9),e.TgZ(25,"div",10),e.TgZ(26,"span"),e._uU(27,"Creation time:"),e.qZA(),e.qZA(),e.TgZ(28,"div",4),e._uU(29),e.qZA(),e.qZA(),e.qZA(),e.TgZ(30,"div",6),e.TgZ(31,"button",11),e._uU(32,"Edit"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(33,"nav",12,13),e.ynx(35,14),e.TgZ(36,"a",15),e._uU(37),e.qZA(),e.YNc(38,$o,14,29,"ng-template",16),e.BQk(),e.ynx(39,14),e.TgZ(40,"a",15),e._uU(41),e.qZA(),e.YNc(42,ea,9,26,"ng-template",16),e.BQk(),e.qZA(),e._UZ(43,"div",17),e.qZA(),e._UZ(44,"ngx-loading",18)),2&t){const i=e.MAs(34);e.xp6(2),e.Q6J("routerLink",e.DdM(9,ta)),e.xp6(5),e.Q6J("routerLink",e.DdM(10,oa)),e.xp6(4),e.hij(" \xa0 ",a.userName," "),e.xp6(4),e.Oqu(a.userName),e.xp6(14),e.hij(" ",a.core.getDate(null==a.userData||null==a.userData.user?null:a.userData.user.createDate)," "),e.xp6(8),e.hij("Groups ",null!=a.userData&&a.userData.summary?"("+(null==a.userData||null==a.userData.summary?null:a.userData.summary.groups)+")":"",""),e.xp6(4),e.hij("Tags ",null!=a.userData&&a.userData.summary?"("+(null==a.userData||null==a.userData.summary?null:a.userData.summary.tags)+")":"",""),e.xp6(2),e.Q6J("ngbNavOutlet",i),e.xp6(1),e.Q6J("show",a.loadingData)}},directives:[p.yS,g.Pz,g.nv,g.Vx,g.uN,T.e,c.sXh,c.ilc,c.mKI,c.XXE,c.qvW,v.p6,c.Ak0,c.Auv,g.tO,Z.RJ],styles:[""]}),o})();function na(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",5),e.TgZ(1,"button",14),e.NdJ("click",function(){return e.CHM(t),e.oxw().getUsers()}),e._UZ(2,"i",15),e.qZA(),e.qZA()}}function ia(o,n){if(1&o&&(e.TgZ(0,"span",32),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij("",null==t.selectedRows?null:t.selectedRows.length," selected")}}const ra=function(o){return["../users/details",o]};function sa(o,n){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"a",1),e._uU(2),e.qZA(),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,ra,t.data.userName)),e.xp6(1),e.Oqu(t.data.userName)}}function la(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(2);e.xp6(1),e.hij(" ",a.core.getDateInMoment(t.data.createDate)," ")}}const ca=function(){return{groupPaging:!1}},da=function(){return[10,20,30,40,50]};function ua(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",16),e.TgZ(2,"button",17),e._uU(3,"Delete"),e.qZA(),e.YNc(4,ia,2,1,"span",18),e.qZA(),e.TgZ(5,"dx-data-grid",19,20),e.NdJ("selectedRowKeysChange",function(i){return e.CHM(t),e.oxw().selectedRows=i}),e._UZ(7,"dxo-paging",21),e._UZ(8,"dxo-pager",22),e._UZ(9,"dxo-load-panel",23),e._UZ(10,"dxo-search-panel",24),e._UZ(11,"dxo-selection",25),e._UZ(12,"dxi-column",26),e._UZ(13,"dxi-column",27),e._UZ(14,"dxi-column",28),e.YNc(15,sa,3,4,"div",29),e.YNc(16,la,2,1,"div",29),e._UZ(17,"dxo-export",30),e._UZ(18,"dxo-column-chooser",31),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("disabled",0==(null==t.selectedRows?null:t.selectedRows.length)),e.xp6(2),e.Q6J("ngIf",null==t.selectedRows?null:t.selectedRows.length),e.xp6(1),e.Q6J("dataSource",t.users)("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("showColumnLines",!1)("allowColumnReordering",!0)("wordWrapEnabled",!0)("selectedRowKeys",t.selectedRows),e.xp6(2),e.Q6J("enabled",!0)("pageSize",20)("remoteOperations",e.DdM(29,ca)),e.xp6(1),e.Q6J("showPageSizeSelector",!0)("allowedPageSizes",e.DdM(30,da))("showInfo",!0),e.xp6(1),e.Q6J("height",75)("width",75)("showPane",!0)("shading",!1),e.xp6(1),e.Q6J("visible",!0)("width",240),e.xp6(2),e.Q6J("visible",!1),e.xp6(1),e.Q6J("allowHiding",!1),e.xp6(2),e.Q6J("dxTemplateOf","userNameTemplate"),e.xp6(1),e.Q6J("dxTemplateOf","createDateTemplate"),e.xp6(1),e.Q6J("enabled",!0)("allowExportSelectedData",!0),e.xp6(1),e.Q6J("enabled",!0)}}function pa(o,n){if(1&o&&(e.TgZ(0,"div",33),e.TgZ(1,"h4",34),e._uU(2,"Unauthorised action"),e.qZA(),e.TgZ(3,"p"),e._uU(4),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(4),e.Oqu(t.unauthorisedDashboard.description)}}const ga=function(){return["../dashboard"]},ma=function(){return["../users/create"]},_a=[{path:"",component:le,children:[{path:"",redirectTo:"dashboard",pathMatch:"prefix"},{path:"dashboard",component:re},{path:"user-groups",children:[{path:"",component:mo},{path:"create",component:Rt},{path:"details/:groupName",children:[{path:"",component:Xt},{path:"add/:addType",component:E}]}]},{path:"users",children:[{path:"",component:(()=>{class o{constructor(t,a){this.core=t,this.idapService=a,this.users=[],this.loadingData=!1,this.unauthorisedDashboard={authorised:!0,description:""},this.selectedRows=[]}ngOnInit(){this.getUsers()}getUsers(){this.loadingData=!0,this.idapService.getUsers().then(t=>{this.loadingData=!1,this.unauthorisedDashboard.authorised=!0,this.users=t.data.users,console.log(this.users)}).catch(t=>{this.loadingData=!1,this.unauthorisedDashboard=this.core.getUnauthorisedErrorMessage(t)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.p),e.Y36(f.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-users"]],decls:25,vars:9,consts:[[1,"container-fluid"],[3,"routerLink"],[1,"fa","fa-chevron-right"],[1,"row"],[1,"col"],[1,"col","d-flex","justify-content-end"],[1,"text-muted"],[1,"pt-3"],[1,"row","pb-2"],[1,"btn","btn-sm","btn-custom-secondary",3,"routerLink"],["class","col d-flex justify-content-end",4,"ngIf"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[3,"show"],["title","Refresh",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fas","fa-sync-alt"],[1,"add-datagrid-buttons"],[1,"btn","btn-sm","btn-danger",3,"disabled"],["class","selection-count text-muted",4,"ngIf"],["noDataText","No data available",3,"dataSource","columnAutoWidth","showBorders","showRowLines","showColumnLines","allowColumnReordering","wordWrapEnabled","selectedRowKeys","selectedRowKeysChange"],["usersContainer",""],[3,"enabled","pageSize","remoteOperations"],[3,"showPageSizeSelector","allowedPageSizes","showInfo"],[3,"height","width","showPane","shading"],["placeholder","Search...",3,"visible","width"],["selectAllMode","allPages","showCheckBoxesMode","always","mode","multiple"],["dataField","userId",3,"visible"],["dataField","userName","caption","Username","cellTemplate","userNameTemplate",3,"allowHiding"],["dataField","createDate","caption","Created at","cellTemplate","createDateTemplate"],[4,"dxTemplate","dxTemplateOf"],["fileName","Users",3,"enabled","allowExportSelectedData"],[3,"enabled"],[1,"selection-count","text-muted"],[1,"alert","alert-danger"],[1,"alert-heading"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"a",1),e._uU(3,"IDAP"),e.qZA(),e._uU(4," \xa0 "),e._UZ(5,"i",2),e._uU(6," \xa0 Users "),e.qZA(),e._UZ(7,"hr"),e.TgZ(8,"div",3),e.TgZ(9,"div",4),e.TgZ(10,"h4"),e._uU(11,"Users"),e.qZA(),e.qZA(),e.TgZ(12,"div",5),e.TgZ(13,"span",6),e._uU(14),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"div",7),e.TgZ(16,"div",8),e.TgZ(17,"div",4),e.TgZ(18,"button",9),e._uU(19,"Create user"),e.qZA(),e.qZA(),e.YNc(20,na,3,0,"div",10),e.qZA(),e.YNc(21,ua,19,31,"ng-container",11),e.YNc(22,pa,5,1,"ng-template",null,12,e.W1O),e.qZA(),e.qZA(),e._UZ(24,"ngx-loading",13)),2&t){const i=e.MAs(23);e.xp6(2),e.Q6J("routerLink",e.DdM(7,ga)),e.xp6(12),e.hij("Total: ",a.users.length,""),e.xp6(4),e.Q6J("routerLink",e.DdM(8,ma)),e.xp6(2),e.Q6J("ngIf",a.unauthorisedDashboard.authorised),e.xp6(1),e.Q6J("ngIf",a.unauthorisedDashboard.authorised)("ngIfElse",i),e.xp6(3),e.Q6J("show",a.loadingData)}},directives:[p.yS,p.rH,m.O5,T.e,c.sXh,c.ilc,c.mKI,c.XXE,c.Lz9,c.qvW,v.p6,c.Ak0,c.Auv,Z.RJ],styles:[""]}),o})()},{path:"create",component:Ho},{path:"details/:userName",children:[{path:"",component:aa}]}]},{path:"policies",children:[{path:"",component:rt},{path:"create",component:He},{path:"details/:policyId",children:[{path:"",component:xt},{path:"add/:addType",component:E}]}]},{path:"account-settings",component:ee}]}];let ha=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[p.Bz.forChild(_a)],p.Bz]}),o})();var Za=u(9426);let fa=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[m.ez,ha,T.x,Z.q,g.Oz,g.lQ,s.UX,w.T5,s.UX,s.u5,Za.ConsoleModule]]}),o})()}}]);